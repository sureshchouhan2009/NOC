<?xml version="1.0" encoding="UTF-8" ?>
<ContentPage
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml" xmlns:components="clr-namespace:NOC.Components" xmlns:xct="http://xamarin.com/schemas/2020/toolkit" x:Name="commentsPageRef"
    x:Class="NOC.Views.CommentsPage">

     <ContentPage.Resources>
        <Style x:Key="circleFram" TargetType="Frame">
            <Setter Property="VerticalOptions" Value="Center" />
            <Setter Property="HorizontalOptions" Value="Center" />
            <Setter Property="BackgroundColor" Value="White" />
            <Setter Property="CornerRadius" Value="30" />
            <Setter Property="Padding" Value="0" />
        </Style>
        <Style x:Key="menuLabel" TargetType="Label">
            <Setter Property="VerticalOptions" Value="Center" />
            <Setter Property="HorizontalOptions" Value="Start" />
            <Setter Property="TextColor" Value="White" />
            <Setter Property="FontSize" Value="16" />
        </Style>
    </ContentPage.Resources>
    <ContentPage.Content>
         <Grid RowDefinitions="Auto,Auto,*,Auto" RowSpacing="0" >
            <Frame Grid.Row="0" Padding="0" HeightRequest="60">
                <Grid>
                    <Image Source="BackArrowRed" HeightRequest="30" WidthRequest="30" HorizontalOptions="Start" VerticalOptions="Center">
                        <Image.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding GoBackCommand}" />
                        </Image.GestureRecognizers>
                    </Image>
                    <Label Text="Transactions Info" Style="{StaticResource TitleLabelStyle}" />

                </Grid>

               
            </Frame>
             <Grid Grid.Row="1" RowDefinitions="Auto,Auto,Auto" Padding="0">
                 <Grid Grid.Row="0" ColumnDefinitions="1.5*,8.5*" Padding="10,10,10,10" BackgroundColor="IndianRed">
                       <Frame Grid.Column="0" Style="{StaticResource circleFram}">
                             <Image Source="doc_icon" Aspect="AspectFit" HeightRequest="35"></Image>
                       </Frame>
                     <!--<Label Grid.Column="1" VerticalOptions="Center"  Style="{StaticResource menuLabel}" Text="wertyuiopoiuytrer" />-->
                     <Label Grid.Column="1" VerticalOptions="Center"  Style="{StaticResource menuLabel}" Text="{Binding TransactonDetail.Transaction.TransactionNumber}" />       
             </Grid>
                 <Frame Grid.Row="1" HeightRequest="30" Padding="10,5,0,5" Margin="0">
                     <Label Text="Comments" TextColor="IndianRed"  FontAttributes="Bold" FontSize="16" />
                 </Frame>
                 <Grid Grid.Row="2" ColumnDefinitions="5*,5*" Margin="10,0,10,0" >
                      <Frame Grid.Column="0"  Padding="0" BackgroundColor="Red" Margin="0">
                         <Label Text="From Processor"  TextColor="White" FontSize="14" VerticalOptions="Center" Padding="5"/>
                     </Frame>
                      <Frame Grid.Column="1"  Padding="0" BackgroundColor="Gray" Margin="0">
                           <Label Text="Notes" FontSize="14" VerticalOptions="Center" TextColor="White" Padding="5" />
                      </Frame>
                 </Grid>
             </Grid>
             <Grid Grid.Row="2" RowDefinitions="Auto,Auto" >
                 <StackLayout Grid.Row="0" Orientation="Horizontal" HeightRequest="20" Spacing="5" Margin="10">
                      <Label Text="Filter by:" FontAttributes="Bold" FontSize="14"  VerticalOptions="Center"/>
                     <Picker WidthRequest="70"  ItemsSource="{Binding PickerSource}" />
                     <RadioButton BorderColor="Black" Content="Accending" HeightRequest="20" FontSize="14" BackgroundColor="Transparent" >
                         <RadioButton.Behaviors>
                              <xct:EventToCommandBehavior EventName="CheckedChanged" Command="{Binding AccendingTappedCommand}" CommandParameter="{Binding IsChecked}"/>
                         </RadioButton.Behaviors>
                     </RadioButton>
                     <RadioButton BorderColor="Black" Content="Decending"  FontSize="14" BackgroundColor="Transparent" >
                          <RadioButton.Behaviors>
                              <xct:EventToCommandBehavior EventName="CheckedChanged" Command="{Binding DecendingTappedCommand}" CommandParameter="{Binding IsChecked}"/>
                         </RadioButton.Behaviors>
                     </RadioButton>
                 </StackLayout>
                 <ListView Grid.Row="1"  ItemsSource="{Binding CommentsList}" HasUnevenRows="True" SeparatorColor="Black" SelectionMode="None">
                     <ListView.ItemTemplate>
                         <DataTemplate>
                             <ViewCell>
                                  <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto" Padding="20,0,20,0">
                                     <Grid Grid.Row="0" RowDefinitions="Auto,Auto" ColumnDefinitions="5*,5*" >
                                           <Label Grid.Row="0" Grid.Column="0" Text="{Binding Users.UserType.UserTypeValue }" HorizontalOptions="Start" VerticalOptions="Center"/>
                                           <Label Grid.Row="0" Grid.Column="1" Text="{Binding Comments.CommentsDate,StringFormat='{0:dd/MM/yyyy}'}" HorizontalOptions="Center" VerticalOptions="Center"/>
                                           <BoxView Grid.Row="1" Grid.ColumnSpan="2" Color="LightGray" HeightRequest="1"/>
                                     </Grid>
                                     <StackLayout Grid.Row="1" Spacing="0">
                                         <Label Text="{Binding Users.ContactEmail,StringFormat='Entered by: {0}'}" FontSize="12"/>
                                         <Label Text="{Binding Users.ContactEmail,StringFormat='Person email: {0}'}" FontSize="12"/>
                                         <Label Text="{Binding Users.ContactMobile,StringFormat='Person office phone no: {0}'}" FontSize="12"/>
                                     </StackLayout>
                                     <Label Grid.Row="2" Text="{Binding Comments.Comment,StringFormat='Comment: {0}'}" TextColor="Black" FontSize="14" Margin="20"/>
                                     <StackLayout Grid.Row="3" Padding="0" HeightRequest="20"  HorizontalOptions="End" Orientation="Horizontal">
                                          <Image Source="message1.png"  BackgroundColor="Blue"/>
                                          <Label Text="Add Reply" FontSize="14" TextColor="Black"/>
                                         <StackLayout.GestureRecognizers>
                                             <TapGestureRecognizer Command="{Binding Source={x:Reference commentsPageRef},Path=BindingContext.AddReplyCommand}" CommandParameter="{Binding .}"/>
                                         </StackLayout.GestureRecognizers>
                                      </StackLayout>
                                     <BoxView Grid.Row="4"  Color="LightGray" HeightRequest="1" Margin="0,10,0,10"/>
                                     <Grid  IsVisible="{Binding IsReplyViewVisible}" Grid.Row="5" RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="5*,5*" >
                                           <Label Grid.Row="0" Grid.Column="0" Text="{Binding Users.UserType.UserTypeValue }" HorizontalOptions="Start" VerticalOptions="Center"/>
                                           <Label Grid.Row="0" Grid.Column="1" Text="{Binding Comments.CommentsDate,StringFormat='{0:dd/MM/yyyy}'}" HorizontalOptions="Center" VerticalOptions="Center"/>
                                           <BoxView Grid.Row="1" Grid.ColumnSpan="2" Color="LightGray" HeightRequest="1"/>
                                            <Frame Grid.Row="2" HeightRequest="120" Grid.ColumnSpan="2" VerticalOptions="FillAndExpand" BorderColor="DarkGray" HasShadow="True" Padding="0">
                                                <components:CustomEditor Text="{Binding ObservationSummaryText}" FontSize="16"  BackgroundColor="Transparent"/>
                                            </Frame>
                                            <StackLayout Grid.Row="3" Grid.ColumnSpan="2" Margin="10" HeightRequest="20"  HorizontalOptions="End" Orientation="Horizontal">
                                          <Image Source="message1.png"  />
                                          <Label Text=" Reply" FontSize="14" TextColor="Black"/>
                                      </StackLayout>

                                     </Grid>

                                  </Grid>
                             </ViewCell>
                         </DataTemplate>
                     </ListView.ItemTemplate>
                 </ListView>
             </Grid>
           
            <Frame Grid.Row="3" Padding="0" HeightRequest="40">
                <Grid ColumnDefinitions="5*, 5*">
                    <Image Grid.Column="0" Source="home" HorizontalOptions="Start">
                        <Image.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding GoHomeCommand}" />
                        </Image.GestureRecognizers>
                    </Image>
                    <Image Grid.Column="1" Source="er_user" HorizontalOptions="End">
                        <Image.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding GoBackCommand}" />
                        </Image.GestureRecognizers>
                    </Image>
                </Grid>
            </Frame>
        </Grid>
    </ContentPage.Content>
</ContentPage>
