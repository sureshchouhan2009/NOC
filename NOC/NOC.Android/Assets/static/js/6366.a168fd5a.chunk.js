"use strict";(self.webpackChunketihadrailapp=self.webpackChunketihadrailapp||[]).push([[6366],{45028:function(t,e,i){i.d(e,{C:function(){return M},b:function(){return k}});var r,n,a,o,s,u,h,c,l=i(30168),f=i(33280),d=i(94951),v=i(48655),p=i(16574),m=i(137),y=i(21002),g=i(15226),_=i(10763),b=i(116),w=i(98634),x=i(64201);function k(t){var e=new x.kG,i=1===t.output;return e.include(d.w,{linearDepth:i}),e.include(v.c,t),e.vertex.uniforms.add("proj","mat4").add("view","mat4"),e.attributes.add("position","vec3"),e.varyings.add("vpos","vec3"),t.multipassTerrainEnabled&&e.varyings.add("depth","float"),i&&(e.include(p.F,t),e.vertex.uniforms.add("cameraNearFar","vec2"),e.varyings.add("linearDepth","float")),e.vertex.code.add((0,w.H)(r||(r=(0,l.Z)(["\n    void main(void) {\n      vpos = position;\n      forwardNormalizedVertexColor();\n      ","\n      gl_Position = ","\n    }\n  "])),t.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"",i?(0,w.H)(n||(n=(0,l.Z)(["transformPositionWithDepth(proj, view, vpos, cameraNearFar, linearDepth);"]))):(0,w.H)(a||(a=(0,l.Z)(["transformPosition(proj, view, vpos);"]))))),e.include(f.p2,t),e.fragment.include(b.Y),t.multipassTerrainEnabled&&(e.fragment.include(y.S),e.include(g.l,t)),e.fragment.uniforms.add("eColor","vec4"),4===t.output&&e.include(m.bA),e.fragment.code.add((0,w.H)(o||(o=(0,l.Z)(["\n  void main() {\n    discardBySlice(vpos);\n    ","\n    vec4 color = ","\n\n    if (color.a < ",") {\n      discard;\n    }\n\n    ","\n\n    ","\n    ",";\n    ",";\n  }\n  "])),t.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",t.attributeColor?"vColor * eColor;":"eColor;",w.H.float(_.bf),7===t.output?(0,w.H)(s||(s=(0,l.Z)(["gl_FragColor = vec4(color.a);"]))):"",0===t.output?(0,w.H)(u||(u=(0,l.Z)(["gl_FragColor = highlightSlice(color, vpos); ",""])),t.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"",4===t.output?(0,w.H)(h||(h=(0,l.Z)(["outputHighlight();"]))):"",1===t.output?(0,w.H)(c||(c=(0,l.Z)(["outputDepth(linearDepth);"]))):"")),e}var M=Object.freeze({__proto__:null,build:k})},82218:function(t,e,i){i.d(e,{a:function(){return w},c:function(){return b},g:function(){return Z},h:function(){return A},u:function(){return k}});var r=i(37762),n=i(43144),a=i(15671),o=(i(93169),i(32718)),s=i(16889),u=i(21530),h=i(14226),c=i(81949),l=i(11186),f=i(71353),d=i(85981),v=i(55652),p=i(40885),m=i(40927),y=i(11185),g=o.Z.getLogger("esri.views.3d.support.geometryUtils.boundedPlane"),_=(0,n.Z)((function t(){(0,a.Z)(this,t),this.plane=(0,v.Ue)(),this.origin=(0,f.c)(),this.basis1=(0,f.c)(),this.basis2=(0,f.c)()}));function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I;return{plane:(0,v.Ue)(t.plane),origin:(0,f.a)(t.origin),basis1:(0,f.a)(t.basis1),basis2:(0,f.a)(t.basis2)}}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b();return x(t.origin,t.basis1,t.basis2,e)}function x(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b();return(0,l.g)(r.origin,t),(0,l.g)(r.basis1,e),(0,l.g)(r.basis2,i),k(r),F(r,"fromValues()"),r}function k(t){(0,v.my)(t.basis2,t.basis1,t.origin,t.plane)}function M(t,e,i){t!==i&&w(t,i);var r=(0,l.a)(y.WM.get(),C(t),e);return(0,l.b)(i.origin,i.origin,r),i.plane[3]-=e,i}function A(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b(),i=(t[2]-t[0])/2,r=(t[3]-t[1])/2;return(0,l.s)(e.origin,t[0]+i,t[1]+r,0),(0,l.s)(e.basis1,i,0,0),(0,l.s)(e.basis2,0,r,0),(0,v.al)(0,0,1,0,e.plane),e}function j(t,e,i){return!!(0,v.BR)(t.plane,e,i)&&z(t,i)}function S(t,e,i){var n=L.get();V(t,e,n,L.get());var a,o=Number.POSITIVE_INFINITY,u=(0,r.Z)(B);try{for(u.s();!(a=u.n()).done;){var h=E(t,a.value,N.get()),c=y.WM.get();if((0,v.rx)(n,h,c)){var f=(0,l.r)(y.WM.get(),e.origin,c),d=Math.abs((0,s.ZF)((0,l.d)(e.direction,f)));d<o&&(o=d,(0,l.g)(i,c))}}}catch(p){u.e(p)}finally{u.f()}return o===Number.POSITIVE_INFINITY?P(t,e,i):i}function P(t,e,i){if(j(t,e,i))return i;var n=L.get(),a=L.get();V(t,e,n,a);var o,s=Number.POSITIVE_INFINITY,u=(0,r.Z)(B);try{for(u.s();!(o=u.n()).done;){var h=E(t,o.value,N.get()),c=y.WM.get();if((0,v.dZ)(n,h,c)){var f=(0,p.Jk)(e,c);if(!(0,v.Ac)(a,c))continue;f<s&&(s=f,(0,l.g)(i,c))}}}catch(d){u.e(d)}finally{u.f()}return O(t,e.origin)<s&&T(t,e.origin,i),i}function T(t,e,i){var r=(0,v.nF)(t.plane,e,y.WM.get()),n=(0,d.ct)(U(t,t.basis1),r,-1,1,y.WM.get()),a=(0,d.ct)(U(t,t.basis2),r,-1,1,y.WM.get());return(0,l.f)(i,(0,l.b)(y.WM.get(),n,a),t.origin),i}function D(t,e,i){var r=t.origin,n=t.basis1,a=t.basis2,o=(0,l.f)(y.WM.get(),e,r),s=(0,m.SR)(n,o),u=(0,m.SR)(a,o),h=(0,m.SR)(C(t),o);return(0,l.s)(i,s,u,h)}function O(t,e){var i=D(t,e,y.WM.get()),r=t.basis1,n=t.basis2,a=(0,l.l)(r),o=(0,l.l)(n),s=Math.max(Math.abs(i[0])-a,0),u=Math.max(Math.abs(i[1])-o,0),h=i[2];return s*s+u*u+h*h}function Z(t,e){return Math.sqrt(O(t,e))}function R(t,e){var i=-t.plane[3];return(0,m.SR)(C(t),e)-i}function C(t){return(0,v.mJ)(t.plane)}function z(t,e){var i=(0,l.f)(y.WM.get(),e,t.origin),r=(0,l.p)(t.basis1),n=(0,l.p)(t.basis2),a=(0,l.d)(t.basis1,i),o=(0,l.d)(t.basis2,i);return-a-r<0&&a-r<0&&-o-n<0&&o-n<0}function U(t,e){var i=N.get();return(0,l.g)(i.origin,t.origin),(0,l.g)(i.vector,e),i}function E(t,e,i){var r=t.basis1,n=t.basis2,a=t.origin,o=(0,l.a)(y.WM.get(),r,e.origin[0]),s=(0,l.a)(y.WM.get(),n,e.origin[1]);(0,l.b)(i.origin,o,s),(0,l.b)(i.origin,i.origin,a);var u=(0,l.a)(y.WM.get(),r,e.direction[0]),h=(0,l.a)(y.WM.get(),n,e.direction[1]);return(0,l.a)(i.vector,(0,l.b)(u,u,h),2),i}function F(t,e){Math.abs((0,l.d)(t.basis1,t.basis2)/((0,l.l)(t.basis1)*(0,l.l)(t.basis2)))>1e-6&&g.warn(e,"Provided basis vectors are not perpendicular"),Math.abs((0,l.d)(t.basis1,C(t)))>1e-6&&g.warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,l.d)(C(t),t.origin)-t.plane[3])>1e-6&&g.warn(e,"Plane offset is not consistent with plane origin")}function V(t,e,i,r){var n=C(t);(0,v.my)(n,e.direction,e.origin,i),(0,v.my)((0,v.mJ)(i),n,e.origin,r)}var I={plane:(0,v.Ue)(),origin:(0,f.f)(0,0,0),basis1:(0,f.f)(1,0,0),basis2:(0,f.f)(0,1,0)},L=new u.x(v.Ue),N=new u.x(d.Ue),G=(0,f.c)(),W=new u.x((function(){return{origin:null,basis1:null,basis2:null,plane:null}})),B=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],q=(0,c.c)(),H=(0,c.c)();Object.freeze({__proto__:null,BoundedPlaneClass:_,create:b,wrap:function(t,e,i){var r=W.get();return r.origin=t,r.basis1=e,r.basis2=i,r.plane=(0,v.re)(0,0,0,0),k(r),r},copy:w,copyWithoutVerify:function(t,e){(0,l.g)(e.origin,t.origin),(0,l.g)(e.basis1,t.basis1),(0,l.g)(e.basis2,t.basis2),(0,v.JG)(t.plane,e.plane)},fromValues:x,updateUnboundedPlane:k,elevate:M,setExtent:function(t,e,i){return A(e,i),M(i,R(t,t.origin),i),i},fromAABoundingRect:A,intersectRay:j,intersectRayClosestSilhouette:function(t,e,i){if(j(t,e,i))return i;var r=S(t,e,y.WM.get());return(0,l.b)(i,e.origin,(0,l.a)(y.WM.get(),e.direction,(0,l.i)(e.origin,r)/(0,l.l)(e.direction))),i},closestPointOnSilhouette:S,closestPoint:P,projectPoint:T,projectPointLocal:D,distance2:O,distance:Z,distanceToSilhouette:function(t,e){var i,n=Number.NEGATIVE_INFINITY,a=(0,r.Z)(B);try{for(a.s();!(i=a.n()).done;){var o=E(t,i.value,N.get()),s=(0,d.Jk)(o,e);s>n&&(n=s)}}catch(u){a.e(u)}finally{a.f()}return Math.sqrt(n)},extrusionContainsPoint:function(t,e){return(0,v.Ac)(t.plane,e)&&z(t,e)},axisAt:function(t,e,i,r){return function(t,e,i){switch(e){case 0:(0,l.g)(i,t.basis1),(0,l.n)(i,i);break;case 1:(0,l.g)(i,t.basis2),(0,l.n)(i,i);break;case 2:(0,l.g)(i,C(t))}return i}(t,i,r)},altitudeAt:R,setAltitudeAt:function(t,e,i,r){var n=R(t,e),a=(0,l.a)(G,C(t),i-n);return(0,l.b)(r,e,a),r},equals:function(t,e){return(0,l.k)(t.basis1,e.basis1)&&(0,l.k)(t.basis2,e.basis2)&&(0,l.k)(t.origin,e.origin)},transform:function(t,e,i){return t!==i&&w(t,i),(0,h.b)(q,e),(0,h.t)(q,q),(0,l.m)(i.basis1,t.basis1,q),(0,l.m)(i.basis2,t.basis2,q),(0,l.m)((0,v.mJ)(i.plane),(0,v.mJ)(t.plane),q),(0,l.m)(i.origin,t.origin,e),(0,v.T5)(i.plane,i.origin,i.plane),i},rotate:function(t,e,i,r){return t!==r&&w(t,r),(0,h.e)(H,(0,h.i)(H),e,i),(0,l.m)(r.basis1,t.basis1,H),(0,l.m)(r.basis2,t.basis2,H),k(r),r},normal:C,UP:I})},70444:function(t,e,i){i.d(e,{Ue:function(){return o},iL:function(){return s},S$:function(){return h},Ws:function(){return u}});var r=i(21530),n=i(11186),a=i(40885);i(11185);function o(t){return t?{ray:(0,a.Ue)(t.ray),c0:t.c0,c1:t.c1}:{ray:(0,a.Ue)(),c0:0,c1:Number.MAX_VALUE}}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o();return(0,a.JG)(t,e.ray),e.c0=0,e.c1=Number.MAX_VALUE,e}function u(t,e){return c(t,t.c0,e)}function h(t,e){return c(t,t.c1,e)}function c(t,e,i){return(0,n.b)(i,t.ray.origin,(0,n.a)(i,t.ray.direction,e))}new r.x((function(){return{c0:0,c1:0,ray:null}}))},95773:function(t,e,i){i.d(e,{JG:function(){return d},Ue:function(){return f},q_:function(){return v},zq:function(){return y},hr:function(){return m}});var r=i(21530),n=i(14226),a=i(11186),o=i(71353),s=i(90045),u=i(67077),h=i(70444),c=i(55652),l=i(11185);function f(t){return t?[(0,c.Ue)(t[0]),(0,c.Ue)(t[1]),(0,c.Ue)(t[2]),(0,c.Ue)(t[3]),(0,c.Ue)(t[4]),(0,c.Ue)(t[5])]:[(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)(),(0,c.Ue)()]}function d(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f(),i=0;i<6;i++)(0,c.JG)(t[i],e[i])}function v(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_,o=(0,n.m)(l.MP.get(),e,t);(0,n.b)(o,o);for(var u=0;u<8;++u){var h=(0,s.t)(l.o6.get(),g[u],o);(0,a.s)(r[u],h[0]/h[3],h[1]/h[3],h[2]/h[3])}p(i,r)}function p(t,e){(0,c.zk)(e[4],e[0],e[3],t[0]),(0,c.zk)(e[1],e[5],e[6],t[1]),(0,c.zk)(e[4],e[5],e[1],t[2]),(0,c.zk)(e[3],e[2],e[6],t[3]),(0,c.zk)(e[0],e[1],e[2],t[4]),(0,c.zk)(e[5],e[4],e[7],t[5])}function m(t,e){for(var i=0;i<6;i++){var r=t[i];if(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=e[3])return!1}return!0}function y(t,e){for(var i=0;i<6;i++){var r=t[i];if(!(0,c.Er)(r,e))return!1}return!0}var g=[(0,u.f)(-1,-1,-1,1),(0,u.f)(1,-1,-1,1),(0,u.f)(1,1,-1,1),(0,u.f)(-1,1,-1,1),(0,u.f)(-1,-1,1,1),(0,u.f)(1,-1,1,1),(0,u.f)(1,1,1,1),(0,u.f)(-1,1,1,1)],_=(new r.x(h.Ue),[(0,o.c)(),(0,o.c)(),(0,o.c)(),(0,o.c)(),(0,o.c)(),(0,o.c)(),(0,o.c)(),(0,o.c)()])},81020:function(t,e,i){function r(t){return"point"===t.type}i.d(e,{f:function(){return r}})},37818:function(t,e,i){i.d(e,{WG:function(){return y},kB:function(){return d},mW:function(){return f},Ou:function(){return c}});var r=i(37762),n=i(52639),a=(i(93169),i(84652)),o=i(92026),s=i(18722),u=i(77981),h=i(65618);function c(t){return"declaredClass"in t}function l(t){return"declaredClass"in t}function f(t,e){if(!t)return null;if("declaredClass"in t)return t;var i=new n.Z({layer:e,sourceLayer:e});return i.visible=t.visible,i.symbol=(0,a.d9)(t.symbol),i.attributes=(0,a.d9)(t.attributes),i.geometry=d(t.geometry),i}function d(t){return(0,o.Wi)(t)?null:c(t)?t:(0,u.im)(function(t){var e=t.spatialReference.toJSON();switch(t.type){case"point":return{x:t.x,y:t.y,z:t.z,m:t.m,spatialReference:e};case"polygon":var i=t.rings,r=t.hasZ,n=t.hasM;return{rings:v(i),hasZ:r,hasM:n,spatialReference:e};case"polyline":var a=t.paths,o=t.hasZ,s=t.hasM;return{paths:v(a),hasZ:o,hasM:s,spatialReference:e};case"extent":return{xmin:t.xmin,xmax:t.xmax,ymin:t.ymin,ymax:t.ymax,zmin:t.zmin,zmax:t.zmax,mmin:t.mmin,mmax:t.mmax,hasZ:t.hasZ,hasM:t.hasM,spatialReference:e};case"multipoint":var u=t.points,h=t.hasZ,c=t.hasM;return{points:m(u)?p(u):u,hasZ:h,hasM:c,spatialReference:e};default:return}}(t))}function v(t){return function(t){var e,i=(0,r.Z)(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(0!==n.length)return m(n)}}catch(a){i.e(a)}finally{i.f()}return!1}(t)?t.map((function(t){return p(t)})):t}function p(t){return t.map((function(t){return(0,s.qo)(t)}))}function m(t){return t.length&&((0,s.xZ)(t[0])||(0,s.fS)(t[0]))}function y(t,e){if(!t)return null;var i;if(l(t)){if(null==e)return t.clone();if(l(e))return e.copy(t)}return null!=e?((i=e).x=t.x,i.y=t.y,i.spatialReference=t.spatialReference,t.hasZ?(i.z=t.z,i.hasZ=t.hasZ):(i.z=null,i.hasZ=!1),t.hasM?(i.m=t.m,i.hasM=!0):(i.m=null,i.hasM=!1)):(i=(0,h.Tx)(t.x,t.y,t.z,t.spatialReference),t.hasM&&(i.m=t.m,i.hasM=!0)),i}},96387:function(t,e,i){i.d(e,{zE:function(){return g},_Z:function(){return S},bD:function(){return M},Si:function(){return P},Go:function(){return w},ZL:function(){return j},Uu:function(){return k},yY:function(){return T},CV:function(){return x},bh:function(){return A}});var r=i(37762),n=i(92026),a=i(14226),o=i(81949),s=i(6394),u=i(71353),h=i(90045),c=i(67077),l=i(60176),f=i(41414),d=i(65156),v=i(4954),p=i(69662),m=i(65618),y=i(37818);function g(t,e){if("point"===t.type)return b(t,e,!1);if((0,y.Ou)(t))switch(t.type){case"extent":return b(t.center,e,!1);case"polygon":return b(t.centroid,e,!1);case"polyline":return b(_(t),e,!0);case"mesh":return b(t.origin,e,!1)}else switch(t.type){case"extent":return b(function(t){var e=isFinite(t.zmin);return(0,m.Tx)(.5*(t.xmax+t.xmin),.5*(t.ymax+t.ymin),e?.5*(t.zmax+t.zmin):void 0,t.spatialReference)}(t),e,!0);case"polygon":return b(function(t){var e=t.rings[0];if(!e||0===e.length)return null;var i=(0,v.a)(t.rings,t.hasZ);return(0,m.Tx)(i[0],i[1],i[2],t.spatialReference)}(t),e,!0);case"polyline":return b(_(t),e,!0)}}function _(t){var e=t.paths[0];if(!e||0===e.length)return null;var i=(0,p.n8)(e,(0,p.ok)(e)/2);return(0,m.Tx)(i[0],i[1],i[2],t.spatialReference)}function b(t,e,i){var r=i?t:(0,y.WG)(t);return e&&t?(0,l.nF)(t,r,e)?r:null:r}function w(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t){e||(e=(0,d.Ue)());var n=t,a=.5*n.width*(i-1),o=.5*n.height*(i-1);return n.width<1e-7*n.height?a+=o/20:n.height<1e-7*n.width&&(o+=a/20),(0,h.s)(e,n.xmin-a-r,n.ymin-o-r,n.xmax+a+r,n.ymax+o+r),e}return null}function x(t,e){for(var i=0;i<t.geometries.length;++i){var r=t.geometries[i].getMutableAttribute("auxpos1");r&&r.data[3]!==e&&(r.data[3]=e,t.geometryVertexAttrsUpdated(t.geometryRecords[i]))}}function k(t,e){var i=(0,c.b)(c.O);return(0,n.pC)(t)&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),(0,n.pC)(e)?i[3]=e:(0,n.pC)(t)&&t.length>3&&(i[3]=t[3]),i}function M(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.O,e=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=new Array(3);if((0,n.Wi)(e)||(0,n.Wi)(i))a[0]=1,a[1]=1,a[2]=1;else{for(var o,s=0,h=2;h>=0;h--){var c=t[h],l=void 0,f=null!=c,d=0===h&&!o&&!f,v=i[h];"symbol-value"===c||d?l=0!==v?e[h]/v:1:f&&"proportional"!==c&&isFinite(c)&&(l=0!==v?c/v:1),null!=l&&(a[h]=l,o=l,s=Math.max(s,Math.abs(l)))}for(var p=2;p>=0;p--)null==a[p]?a[p]=o:0===a[p]&&(a[p]=.001*s)}for(var m=2;m>=0;m--)a[m]/=r;return(0,u.d)(a)}function A(t){return function(t){return null!=t.isPrimitive}(t)&&(t=[t.width,t.depth,t.height]),j(t)?null:"Symbol sizes may not be negative values"}function j(t){if(Array.isArray(t)){var e,i=(0,r.Z)(t);try{for(i.s();!(e=i.n()).done;){if(!j(e.value))return!1}}catch(n){i.e(n)}finally{i.f()}return!0}return null==t||t>=0}function S(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,o.c)(),n=t||0,s=e||0,u=i||0;return 0!==n&&(0,a.r)(r,r,-n/180*Math.PI),0!==s&&(0,a.d)(r,r,s/180*Math.PI),0!==u&&(0,a.j)(r,r,u/180*Math.PI),r}function P(t,e){return null!=e.minDemResolution?e.minDemResolution:(0,f.wp)(t)?e.minDemResolutionForPoints:.01*(0,f.aO)(t)}var T={"bottom-left":(0,s.f)(0,0),bottom:(0,s.f)(.5,0),"bottom-right":(0,s.f)(1,0),left:(0,s.f)(0,.5),center:(0,s.f)(.5,.5),right:(0,s.f)(1,.5),"top-left":(0,s.f)(0,1),top:(0,s.f)(.5,1),"top-right":(0,s.f)(1,1)}},77648:function(t,e,i){i.d(e,{sb:function(){return s},KO:function(){return h},Fb:function(){return u}});var r=i(43144),n=i(15671),a=i(92026),o=i(81020),s=(0,r.Z)((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,n.Z)(this,t),this.array=e,this.spatialReference=i,this.offset=r}));function u(t){return"array"in t}function h(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ground";if((0,o.f)(e))return t.getElevation(e.x,e.y,e.z||0,e.spatialReference,i);if(u(e)){var r=e.offset;return t.getElevation(e.array[r++],e.array[r++],e.array[r]||0,(0,a.Pt)(e.spatialReference,t.spatialReference),i)}return t.getElevation(e[0],e[1],e[2]||0,t.spatialReference,i)}},50256:function(t,e,i){function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t.stride;return t.fieldNames.filter((function(e){var i=t.fields.get(e).optional;return!(i&&i.glPadding)})).map((function(r){var a=t.fields.get(r),o=a.constructor.ElementCount,s=n(a.constructor.ElementType),u=a.offset,h=!(!a.optional||!a.optional.glNormalized);return{name:r,stride:i,count:o,type:s,offset:u,normalized:h,divisor:e}}))}function n(t){var e=a[t];if(e)return e;throw new Error("BufferType not supported in WebGL")}i.d(e,{K:function(){return r}});var a={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126}},74321:function(t,e,i){i.d(e,{k:function(){return o}});var r,n=i(30168),a=i(98634);function o(t){t.attributes.add("position","vec2"),t.varyings.add("uv","vec2"),t.vertex.code.add((0,a.H)(r||(r=(0,n.Z)(["\n    void main(void) {\n      gl_Position = vec4(position, 0.0, 1.0);\n      uv = position * 0.5 + vec2(0.5);\n    }\n  "]))))}},30425:function(t,e,i){i.d(e,{Z:function(){return x}});var r=i(15671),n=i(43144),a=i(32718),o=i(16889),s=i(92026),u=i(17842),h=i(14226),c=i(81949),l=i(88396),f=i(6394),d=i(11186),v=i(71353),p=i(90045),m=i(67077),y=i(95773),g=i(40885),_=i(40927),b=i(97731),w=a.Z.getLogger("esri.views.3d.webgl-engine.lib.Camera"),x=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,r.Z)(this,t),this._viewUp=(0,v.c)(),this._viewForward=(0,v.c)(),this._viewRight=(0,v.c)(),this._ray=(0,g.Ue)(),this._viewport=(0,m.f)(0,0,1,1),this._padding=(0,m.f)(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=(0,f.f)(1,1e3),this._viewDirty=!0,this._viewMatrix=(0,c.c)(),this._projectionDirty=!0,this._projectionMatrix=(0,c.c)(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=(0,c.c)(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=(0,c.c)(),this._frustumDirty=!0,this._frustum=(0,y.Ue)(),this._fullViewport=(0,m.c)(),this.pixelRatio=1,this.relativeElevation=0,(0,s.pC)(e)&&(0,d.g)(this._ray.origin,e),this._center=(0,s.pC)(i)?(0,v.a)(i):(0,v.c)(),this._up=(0,s.pC)(n)?(0,v.a)(n):(0,v.f)(0,0,1)}return(0,n.Z)(t,[{key:"eye",get:function(){return this._ray.origin},set:function(t){this._compareAndSetView(t,this._ray.origin)}},{key:"center",get:function(){return this._center},set:function(t){this._compareAndSetView(t,this._center)}},{key:"ray",get:function(){return(0,d.f)(this._ray.direction,this.center,this.eye),this._ray}},{key:"up",get:function(){return this._up},set:function(t){this._compareAndSetView(t,this._up)}},{key:"viewMatrix",get:function(){return this._ensureViewClean(),this._viewMatrix},set:function(t){(0,h.c)(this._viewMatrix,t),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"viewForward",get:function(){return this._ensureViewClean(),this._viewForward}},{key:"viewUp",get:function(){return this._ensureViewClean(),this._viewUp}},{key:"viewRight",get:function(){return this._ensureViewClean(),this._viewRight}},{key:"nearFar",get:function(){return this._nearFar}},{key:"near",get:function(){return this._nearFar[0]},set:function(t){this._nearFar[0]!==t&&(this._nearFar[0]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"far",get:function(){return this._nearFar[1]},set:function(t){this._nearFar[1]!==t&&(this._nearFar[1]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"viewport",get:function(){return this._viewport},set:function(t){this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3]}},{key:"x",get:function(){return this._viewport[0]},set:function(t){t+=this._padding[3],this._viewport[0]!==t&&(this._viewport[0]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"y",get:function(){return this._viewport[1]},set:function(t){t+=this._padding[2],this._viewport[1]!==t&&(this._viewport[1]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"width",get:function(){return this._viewport[2]},set:function(t){this._viewport[2]!==t&&(this._viewport[2]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"height",get:function(){return this._viewport[3]},set:function(t){this._viewport[3]!==t&&(this._viewport[3]=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"fullWidth",get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},set:function(t){this.width=t-(this._padding[1]+this._padding[3])}},{key:"fullHeight",get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},set:function(t){this.height=t-(this._padding[0]+this._padding[2])}},{key:"fullViewport",get:function(){return this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}},{key:"aspect",get:function(){return this.width/this.height}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding[0]===t[0]&&this._padding[1]===t[1]&&this._padding[2]===t[2]&&this._padding[3]===t[3]||(this._viewport[0]+=t[3]-this._padding[3],this._viewport[1]+=t[2]-this._padding[2],this._viewport[2]-=t[1]+t[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=t[0]+t[2]-(this._padding[0]+this._padding[2]),(0,p.c)(this._padding,t),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"viewProjectionMatrix",get:function(){return this._viewProjectionDirty&&((0,h.m)(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}},{key:"projectionMatrix",get:function(){if(this._projectionDirty){var t=this.width,e=this.height,i=this.near*Math.tan(this.fovY/2),r=i*this.aspect;(0,h.h)(this._projectionMatrix,-r*(1+2*this._padding[3]/t),r*(1+2*this._padding[1]/t),-i*(1+2*this._padding[2]/e),i*(1+2*this._padding[0]/e),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix},set:function(t){(0,h.c)(this._projectionMatrix,t),this._projectionDirty=!1,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fov",get:function(){return this._fov},set:function(t){this._fov=t,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fovX",get:function(){return(0,b.tM)(this._fov,this.width,this.height)},set:function(t){this._fov=(0,b.Kj)(t,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fovY",get:function(){return(0,b.RQ)(this._fov,this.width,this.height)},set:function(t){this._fov=(0,b.zF)(t,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"distance",get:function(){return(0,d.i)(this._center,this.eye)}},{key:"frustum",get:function(){return this._recomputeFrustum(),this._frustum}},{key:"viewInverseTransposeMatrix",get:function(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&((0,h.b)(this._viewInverseTransposeMatrix,this.viewMatrix),(0,h.t)(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}},{key:"depthNDCToWorld",value:function(t){var e=2*t-1;return 2*this.near*this.far/(this.far+this.near-e*(this.far-this.near))}},{key:"perRenderPixelRatio",get:function(){return Math.tan(this.fovX/2)/(this.width/2)}},{key:"perScreenPixelRatio",get:function(){return this.perRenderPixelRatio*this.pixelRatio}},{key:"aboveGround",get:function(){return this.relativeElevation&&this.relativeElevation>=0}},{key:"copyFrom",value:function(t){(0,d.g)(this._ray.origin,t.eye),(0,d.g)(this._center,t.center),(0,d.g)(this._up,t.up),(0,p.c)(this._viewport,t.viewport),(0,p.c)(this._padding,t.padding),(0,l.c)(this._nearFar,t.nearFar),this._fov=t.fov,this.relativeElevation=t.relativeElevation;var e=t;return this._viewDirty=e._viewDirty,this._viewDirty||((0,h.c)(this._viewMatrix,t.viewMatrix),(0,d.g)(this._viewRight,t.viewRight),(0,d.g)(this._viewUp,t.viewUp),(0,d.g)(this._viewForward,t.viewForward)),e._projectionDirty?this._projectionDirty=!0:((0,h.c)(this._projectionMatrix,t.projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._frustumDirty=e._frustumDirty,this._frustumDirty||((0,y.JG)(t.frustum,this._frustum),this._frustumDirty=!1),e._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:((0,h.c)(this._viewInverseTransposeMatrix,t.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),(0,p.c)(this._fullViewport,t.fullViewport),this.pixelRatio=t.pixelRatio,this}},{key:"copyViewFrom",value:function(t){this.eye=t.eye,this.center=t.center,this.up=t.up}},{key:"clone",value:function(){return(new t).copyFrom(this)}},{key:"equals",value:function(t){return(0,d.k)(this.eye,t.eye)&&(0,d.k)(this._center,t.center)&&(0,d.k)(this._up,t.up)&&(0,p.g)(this._viewport,t.viewport)&&(0,p.g)(this._padding,t.padding)&&(0,l.e)(this._nearFar,t.nearFar)&&this._fov===t.fov&&this.pixelRatio===t.pixelRatio&&this.relativeElevation===t.relativeElevation}},{key:"almostEquals",value:function(t){if(this.pixelRatio!==t.pixelRatio||Math.abs(t.fov-this._fov)>=.001)return!1;var e=5e-4;(0,d.v)(A,t.eye,t.center),(0,d.v)(j,this.eye,this._center);var i=(0,d.d)(A,j),r=(0,d.w)(A),n=(0,d.w)(j);return i*i>=(1-1e-10)*r*n&&(0,d.x)(t.eye,this.eye)<Math.max(r,n)*e*e&&(0,p.i)(t.padding,this._padding)<.5&&(0,p.i)(t.viewport,this._viewport)<.5}},{key:"computeRenderPixelSizeAt",value:function(t){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(t))}},{key:"computeRenderPixelSizeAtDist",value:function(t){return t*this.perRenderPixelRatio}},{key:"computeScreenPixelSizeAt",value:function(t){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(t))}},{key:"viewDirectionDistance",value:function(t){return Math.abs((0,_.SR)(this.viewForward,(0,d.f)(A,t,this.eye)))}},{key:"computeScreenPixelSizeAtDist",value:function(t){return t*this.perScreenPixelRatio}},{key:"computeDistanceFromRadius",value:function(t,e){return t/Math.tan(Math.min(this.fovX,this.fovY)/(2*(e||1)))}},{key:"getScreenCenter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,u.s1)();return t[0]=(this.padding[3]+this.width/2)/this.pixelRatio,t[1]=(this.padding[0]+this.height/2)/this.pixelRatio,t}},{key:"getRenderCenter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return t[0]=this.padding[3]+this.width*e,t[1]=this.padding[2]+this.height*i,t[2]=.5,t}},{key:"setGLViewport",value:function(t){var e=this.viewport,i=this.padding;t.setViewport(e[0]-i[3],e[1]-i[2],e[2]+i[1]+i[3],e[3]+i[0]+i[2])}},{key:"applyProjection",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t!==k&&(0,d.g)(k,t),k[3]=1,i&&(e[2]=-k[2]),(0,p.t)(k,k,this.projectionMatrix),(0,d.a)(k,k,1/Math.abs(k[3]));var r=this.fullViewport;return e[0]=(0,o.t7)(0,r[0]+r[2],.5+.5*k[0]),e[1]=(0,o.t7)(0,r[1]+r[3],.5+.5*k[1]),i||(e[2]=.5*(k[2]+1)),e}},{key:"projectToScreen",value:function(t,e){this.projectToRenderScreen(t,S),this.renderToScreen(S,e)}},{key:"projectToRenderScreen",value:function(t,e){if(k[0]=t[0],k[1]=t[1],k[2]=t[2],k[3]=1,(0,p.t)(k,k,this.viewProjectionMatrix),0===k[3])return null;(0,d.a)(k,k,1/Math.abs(k[3]));var i=this.fullViewport;return"x"in e?(e.x=(0,o.t7)(0,i[0]+i[2],.5+.5*k[0]),e.y=(0,o.t7)(0,i[1]+i[3],.5+.5*k[1])):(e[0]=(0,o.t7)(0,i[0]+i[2],.5+.5*k[0]),e[1]=(0,o.t7)(0,i[1]+i[3],.5+.5*k[1]),e.length>2&&(e[2]=.5*(k[2]+1))),e}},{key:"unprojectFromScreen",value:function(t,e){return this.unprojectFromRenderScreen(this.screenToRender(t,S),e)}},{key:"unprojectFromRenderScreen",value:function(t,e){if((0,h.m)(M,this.projectionMatrix,this.viewMatrix),!(0,h.b)(M,M))return null;var i=this.fullViewport;return k[0]=2*(t[0]-i[0])/i[2]-1,k[1]=2*(t[1]-i[1])/i[3]-1,k[2]=2*t[2]-1,k[3]=1,(0,p.t)(k,k,M),0===k[3]?null:(e[0]=k[0]/k[3],e[1]=k[1]/k[3],e[2]=k[2]/k[3],e)}},{key:"constrainWindowSize",value:function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i,n=t*this.pixelRatio,a=e*this.pixelRatio,o=Math.max(n-i/2,0),s=Math.max(this.fullHeight-a-r/2,0),u=-Math.min(n-i/2,0),h=-Math.min(this.fullHeight-a-r/2,0);return[o,s,i-u- -Math.min(this.fullWidth-n-i/2,0),r-h- -Math.min(a-r/2,0)]}},{key:"computeUp",value:function(t){1===t?this.computeUpGlobal():this.computeUpLocal()}},{key:"screenToRender",value:function(t,e){var i=t[0]*this.pixelRatio,r=this.fullHeight-t[1]*this.pixelRatio;return e[0]=i,e[1]=r,e}},{key:"renderToScreen",value:function(t,e){var i=t[0]/this.pixelRatio,r=(this.fullHeight-t[1])/this.pixelRatio;e[0]=i,e[1]=r}},{key:"computeUpGlobal",value:function(){(0,d.f)(A,this.center,this.eye);var t=(0,d.l)(this.center);t<1?((0,d.s)(this._up,0,0,1),this._markViewDirty()):Math.abs((0,d.d)(A,this.center))>.9999*(0,d.l)(A)*t||((0,d.c)(this._up,A,this.center),(0,d.c)(this._up,this._up,A),(0,d.n)(this._up,this._up),this._markViewDirty())}},{key:"computeUpLocal",value:function(){(0,d.r)(A,this.eye,this.center),Math.abs(A[2])<=.9999&&((0,d.a)(A,A,A[2]),(0,d.s)(this._up,-A[0],-A[1],1-A[2]),(0,d.n)(this._up,this._up),this._markViewDirty())}},{key:"_compareAndSetView",value:function(t,e){"number"==typeof t[0]&&isFinite(t[0])&&"number"==typeof t[1]&&isFinite(t[1])&&"number"==typeof t[2]&&isFinite(t[2])?(0,d.k)(t,e)||((0,d.g)(e,t),this._markViewDirty()):w.warn("Camera vector contains invalid number, ignoring value")}},{key:"_markViewDirty",value:function(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}},{key:"_recomputeFrustum",value:function(){this._frustumDirty&&((0,y.q_)(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}},{key:"_ensureViewClean",value:function(){this._viewDirty&&((0,h.l)(this._viewMatrix,this.eye,this._center,this._up),(0,d.s)(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),(0,d.s)(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),(0,d.s)(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}}]),t}(),k=(0,m.c)(),M=(0,c.c)(),A=(0,v.c)(),j=(0,v.c)(),S=(0,u.J$)()},94425:function(t,e,i){i.d(e,{p:function(){return o},S:function(){return s}});var r=i(15671),n=i(43144),a=i(92026),o=function(){function t(e,i){(0,r.Z)(this,t),this._material=e,this._repository=i,this._map=new Map}return(0,n.Z)(t,[{key:"destroy",value:function(){var t=this;this._map.forEach((function(e,i){(0,a.pC)(e)&&t._repository.release(t._material,s(i))}))}},{key:"load",value:function(t,e){this._map.has(e)||this._map.set(e,this._repository.acquire(this._material,s(e)));var i=this._map.get(e);if((0,a.pC)(i)){if(2===i.ensureResources(t))return i;this._repository.requestRender()}return null}}]),t}();function s(t){switch(t){default:case 0:return 0;case 1:return 7;case 4:case 7:case 6:return 3;case 3:return 2;case 2:return 1;case 5:return 4}}},70619:function(t,e,i){i.d(e,{Z:function(){return _}});var r,n=i(11186),a=i(8229),o=i(71353),s=i(55652),u=i(40885);!function(t){t.length=function(t,e){var i=t[e],r=t[e+1],n=t[e+2];return Math.sqrt(i*i+r*r+n*n)},t.normalize=function(t,e){var i=t[e],r=t[e+1],n=t[e+2],a=1/Math.sqrt(i*i+r*r+n*n);t[e]*=a,t[e+1]*=a,t[e+2]*=a},t.scale=function(t,e,i){t[e]*=i,t[e+1]*=i,t[e+2]*=i},t.add=function(t,e,i,r,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e;(n=n||t)[a]=t[e]+i[r],n[a+1]=t[e+1]+i[r+1],n[a+2]=t[e+2]+i[r+2]},t.subtract=function(t,e,i,r,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e;(n=n||t)[a]=t[e]-i[r],n[a+1]=t[e+1]-i[r+1],n[a+2]=t[e+2]-i[r+2]}}(r||(r={}));var h,c,l,f,d=i(74894),v=i(81935),p=i(97731),m=r;!function(t){for(var e=.5,i=[[-e,-e,e],[e,-e,e],[e,e,e],[-e,e,e],[-e,-e,-e],[e,-e,-e],[e,e,-e],[-e,e,-e]],r=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],n=[0,0,1,0,1,1,0,1],a=new Uint16Array([0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5]),o=new Uint16Array(36),s=0;s<6;s++)for(var u=0;u<6;u++)o[6*s+u]=s;for(var h=new Uint16Array(36),c=0;c<6;c++)h[6*c+0]=0,h[6*c+1]=1,h[6*c+2]=2,h[6*c+3]=2,h[6*c+4]=3,h[6*c+5]=0;t.createGeometry=function(t){Array.isArray(t)||(t=[t,t,t]);for(var e=new Array(24),s=0;s<8;s++)e[3*s]=i[s][0]*t[0],e[3*s+1]=i[s][1]*t[1],e[3*s+2]=i[s][2]*t[2];return new d.Z([["position",{size:3,data:e,exclusive:!0}],["normal",{size:3,data:r}],["uv0",{size:2,data:n}]],[["position",a],["normal",o],["uv0",h]])}}(h||(h={})),function(t){var e=.5,i=[[-e,0,-e],[e,0,-e],[e,0,e],[-e,0,e],[0,-e,0],[0,e,0]],r=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],n=new Uint16Array([5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0]),a=new Uint16Array([0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7]);t.createGeometry=function(t){Array.isArray(t)||(t=[t,t,t]);for(var e=new Array(18),o=0;o<6;o++)e[3*o]=i[o][0]*t[0],e[3*o+1]=i[o][1]*t[1],e[3*o+2]=i[o][2]*t[2];return new d.Z([["position",{size:3,data:e,exclusive:!0}],["normal",{size:3,data:r}]],[["position",n],["normal",a]])}}(c||(c={})),function(t){var e=.5,i=(0,a.f)(-e,0,-e),r=(0,a.f)(e,0,-e),o=(0,a.f)(0,0,e),s=(0,a.f)(0,.5,0),u=(0,a.c)(),h=(0,a.c)(),c=(0,a.c)(),l=(0,a.c)(),f=(0,a.c)();(0,n.f)(u,i,s),(0,n.f)(h,i,r),(0,n.c)(c,u,h),(0,n.n)(c,c),(0,n.f)(u,r,s),(0,n.f)(h,r,o),(0,n.c)(l,u,h),(0,n.n)(l,l),(0,n.f)(u,o,s),(0,n.f)(h,o,i),(0,n.c)(f,u,h),(0,n.n)(f,f);var v=[i,r,o,s],p=[0,-1,0,c[0],c[1],c[2],l[0],l[1],l[2],f[0],f[1],f[2]],m=[0,1,2,3,1,0,3,2,1,3,0,2],y=[0,0,0,1,1,1,2,2,2,3,3,3];t.createGeometry=function(t){Array.isArray(t)||(t=[t,t,t]);for(var e=new Array(12),i=0;i<4;i++)e[3*i]=v[i][0]*t[0],e[3*i+1]=v[i][1]*t[1],e[3*i+2]=v[i][2]*t[2];return new d.Z([["position",{size:3,data:e,exclusive:!0}],["normal",{size:3,data:p}]],[["position",new Uint16Array(m)],["normal",new Uint16Array(y)]])}}(l||(l={})),function(t){t.createBoxGeometry=h.createGeometry,t.createDiamondGeometry=c.createGeometry,t.createTetrahedronGeometry=l.createGeometry,t.createSphereGeometry=function(t,e,i){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{uv:!0},n=-Math.PI,a=2*Math.PI,o=-Math.PI/2,s=Math.PI,u=Math.max(3,Math.floor(e)),h=Math.max(2,Math.floor(i)),c=(u+1)*(h+1),l=new Float32Array(3*c),f=new Float32Array(3*c),v=new Float32Array(2*c),p=[],m=0,y=0;y<=h;y++){for(var g=[],_=y/h,b=o+_*s,w=Math.cos(b),x=0;x<=u;x++){var k=x/u,M=n+k*a,A=Math.cos(M)*w,j=Math.sin(b),S=-Math.sin(M)*w;l[3*m]=A*t,l[3*m+1]=j*t,l[3*m+2]=S*t,f[3*m]=A,f[3*m+1]=j,f[3*m+2]=S,v[2*m]=k,v[2*m+1]=_,g.push(m),++m}p.push(g)}var P=new Uint32Array(2*u*(h-1)*3);m=0;for(var T=0;T<h;T++)for(var D=0;D<u;D++){var O=p[T][D],Z=p[T][D+1],R=p[T+1][D+1],C=p[T+1][D];0===T?(P[m++]=O,P[m++]=R,P[m++]=C):T===h-1?(P[m++]=O,P[m++]=Z,P[m++]=R):(P[m++]=O,P[m++]=Z,P[m++]=R,P[m++]=R,P[m++]=C,P[m++]=O)}var z=[["position",P],["normal",P]],U=[["position",{size:3,data:l,exclusive:!0}],["normal",{size:3,data:f,exclusive:!0}]];return r.uv&&(U.push(["uv0",{size:2,data:v,exclusive:!0}]),z.push(["uv0",P])),r.offset&&(z[0][0]="offset",U[0][0]="offset",z.push(["position",new Uint32Array(P.length)]),U.push(["position",{size:3,data:Float64Array.from(r.offset),exclusive:!0}])),new d.Z(U,z)},t.createPolySphereGeometry=function(t,e,i){var r,n,a=t;if(i)r=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],n=new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]);else{var o=a*(1+Math.sqrt(5))/2;r=[-a,o,0,a,o,0,-a,-o,0,a,-o,0,0,-a,o,0,a,o,0,-a,-o,0,a,-o,o,0,-a,o,0,a,-o,0,-a,-o,0,a],n=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1])}for(var s=0;s<r.length;s+=3)m.scale(r,s,t/m.length(r,s));var u={};function h(e,i){var n;e>i&&(e=(n=[i,e])[0],i=n[1]);var a=e.toString()+"."+i.toString();if(u[a])return u[a];var o=r.length;return r.length+=3,m.add(r,3*e,r,3*i,r,o),m.scale(r,o,t/m.length(r,o)),o/=3,u[a]=o,o}for(var c=0;c<e;c++){for(var l=n.length,f=new Uint32Array(4*l),v=0;v<l;v+=3){var p=n[v],y=n[v+1],g=n[v+2],_=h(p,y),b=h(y,g),w=h(g,p),x=4*v;f[x]=p,f[x+1]=_,f[x+2]=w,f[x+3]=y,f[x+4]=b,f[x+5]=_,f[x+6]=g,f[x+7]=w,f[x+8]=b,f[x+9]=_,f[x+10]=b,f[x+11]=w}n=f,u={}}for(var k=new Float32Array(r),M=0;M<k.length;M+=3)m.normalize(k,M);var A=[["position",n],["normal",n]],j=[["position",{size:3,data:new Float32Array(r),exclusive:!0}],["normal",{size:3,data:k,exclusive:!0}]];return new d.Z(j,A)},t.createPointGeometry=function(t,e,i,r,n,a,o){var s=e?[e[0],e[1],e[2]]:[0,0,0],u=t?[t[0],t[1],t[2]]:[0,0,1];a=a||[0,0];var h=i?[255*i[0],255*i[1],255*i[2],i.length>3?255*i[3]:255]:[255,255,255,255],c=null!=r&&2===r.length?r:[1,1],l=[["position",{size:3,data:s,exclusive:!0}],["normal",{size:3,data:u,exclusive:!0}],["uv0",{size:a.length,data:a}],["color",{size:4,data:h,exclusive:!0}],["size",{size:2,data:c}]];if(null!=n){var f=new Float32Array([n[0],n[1],n[2],n[3]]);l.push(["auxpos1",{size:4,data:f}])}if(null!=o){var v=new Float32Array([o[0],o[1],o[2],o[3]]);l.push(["auxpos2",{size:4,data:v}])}return new d.Z(l,null,1)},t.updatePointGeometry=function(t,e,i,r,n,a,o,s){if(null!=t){var u=s.getMutableAttribute("normal").data;u[0]=t[0],u[1]=t[1],u[2]=t[2]}if(null!=e){var h=s.getMutableAttribute("position").data;h[0]=e[0],h[1]=e[1],h[2]=e[2]}if(null!=i){var c=s.getMutableAttribute("color").data;c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[3]}if(null!=r){var l=s.getMutableAttribute("size").data;l[0]=r[0],l[1]=r[1]}if(null!=n){var f=s.getMutableAttribute("auxpos1").data;f[0]=n[0],f[1]=n[1],f[2]=n[2],f[3]=n[3]}if(null!=a){var d=s.getMutableAttribute("uv0").data;d[0]=a[0],d[1]=a[1]}if(null!=o){var v=s.getMutableAttribute("auxpos2").data;v[0]=o[0],v[1]=o[1],v[2]=o[2],v[3]=o[3]}},t.createPointArrayGeometry=function(t,e){for(var i=new Float32Array(3*t.length),r=new Float32Array(e?3*t.length:3),n=new Uint32Array(t.length),a=new Uint32Array(t.length),o=0;o<t.length;o++)i[3*o]=t[o][0],i[3*o+1]=t[o][1],i[3*o+2]=t[o][2],e&&(r[3*o]=e[o][0],r[3*o+1]=e[o][1],r[3*o+2]=e[o][2]),n[o]=o,a[o]=0;return e||(r[0]=0,r[1]=1,r[2]=0),new d.Z([["position",{size:3,data:i,exclusive:!0}],["normal",{size:3,data:r,exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",n],["normal",e?n:a],["uv0",a]],1)},t.createTriangleGeometry=function(){var t=new Uint16Array([0,1,2]),e=new Uint16Array([0,0,0]),i=new Uint16Array([0,0,0]);return new d.Z([["position",{size:3,data:[0,0,0,0,0,100,100,0,0],exclusive:!0}],["normal",{size:3,data:[0,1,0],exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",t],["normal",e],["uv0",i]])};var e=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function i(t,e,i,r,a){return!(Math.abs((0,n.d)(e,t))>a)&&((0,n.c)(i,t,e),(0,n.n)(i,i),(0,n.c)(r,i,t),(0,n.n)(r,r),!0)}function r(t,e,r,n,a,o,s){return i(t,e,a,o,s)||i(t,r,a,o,s)||i(t,n,a,o,s)}t.createSquareGeometry=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,i=new Array(12),r=0;r<4;r++)for(var n=0;n<3;n++)i[3*r+n]=t[r][n];var a=new Uint32Array([0,1,2,2,3,0]),o=[0,0,1],s=new Uint32Array([0,0,0,0,0,0]);return new d.Z([["position",{size:3,data:i,exclusive:!0}],["normal",{size:3,data:o,exclusive:!0}],["uv0",{size:2,data:[0,0,1,0,1,1,0,1],exclusive:!0}],["color",{size:4,data:[255,255,255,255],exclusive:!0}]],[["position",a],["normal",s],["uv0",a],["color",s]])},t.createConeGeometry=function(t,e,i,r){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=0,u=e,h=t,c=(0,a.f)(0,s,0),l=(0,a.f)(0,s+h,0),f=(0,a.f)(0,-1,0),v=(0,a.f)(0,1,0);r&&(s=h,l=(0,a.f)(0,0,0),c=(0,a.f)(0,s,0),f=(0,a.f)(0,1,0),v=(0,a.f)(0,-1,0));var p=[l,c],m=[f,v],y=i+2,g=Math.sqrt(h*h+u*u);if(r)for(var _=i-1;_>=0;_--){var b=_*(2*Math.PI/i),w=(0,a.f)(Math.cos(b)*u,s,Math.sin(b)*u);p.push(w);var x=(0,a.f)(h*Math.cos(b)/g,-u/g,h*Math.sin(b)/g);m.push(x)}else for(var k=0;k<i;k++){var M=k*(2*Math.PI/i),A=(0,a.f)(Math.cos(M)*u,s,Math.sin(M)*u);p.push(A);var j=(0,a.f)(h*Math.cos(M)/g,u/g,h*Math.sin(M)/g);m.push(j)}var S=new Uint32Array(2*(i+2)*3),P=new Uint32Array(2*(i+2)*3),T=0,D=0;if(n){for(var O=3;O<p.length;O++)S[T++]=1,S[T++]=O-1,S[T++]=O,P[D++]=0,P[D++]=0,P[D++]=0;S[T++]=p.length-1,S[T++]=2,S[T++]=1,P[D++]=0,P[D++]=0,P[D++]=0}if(o){for(var Z=3;Z<p.length;Z++)S[T++]=Z,S[T++]=Z-1,S[T++]=0,P[D++]=Z,P[D++]=Z-1,P[D++]=1;S[T++]=0,S[T++]=2,S[T++]=p.length-1,P[D++]=1,P[D++]=2,P[D++]=m.length-1}for(var R=new Float32Array(3*y),C=0;C<y;C++)R[3*C]=p[C][0],R[3*C+1]=p[C][1],R[3*C+2]=p[C][2];for(var z=new Float32Array(3*y),U=0;U<y;U++)z[3*U]=m[U][0],z[3*U+1]=m[U][1],z[3*U+2]=m[U][2];return new d.Z([["position",{size:3,data:R,exclusive:!0}],["normal",{size:3,data:z,exclusive:!0}]],[["position",S],["normal",P]])},t.createCylinderGeometry=function(t,e,i,r,o,s){var u=r?(0,a.a)(r):(0,a.f)(1,0,0),h=o?(0,a.a)(o):(0,a.f)(0,0,0);s=null==s||s;var c=(0,a.c)();(0,n.n)(c,u);var l=(0,a.c)();(0,n.a)(l,c,Math.abs(t));var f=(0,a.c)();(0,n.a)(f,l,-.5),(0,n.b)(f,f,h);var v=(0,a.f)(0,1,0);Math.abs(1-(0,n.d)(c,v))<.2&&(0,n.s)(v,0,0,1);var p=(0,a.c)();(0,n.c)(p,c,v),(0,n.n)(p,p),(0,n.c)(v,p,c);var m=2*i+(s?2:0),y=i+(s?2:0),g=new Float32Array(3*m),_=new Float32Array(3*y),b=new Float32Array(2*m),w=new Uint32Array(3*i*(s?4:2)),x=new Uint32Array(3*i*(s?4:2));s&&(g[3*(m-2)+0]=f[0],g[3*(m-2)+1]=f[1],g[3*(m-2)+2]=f[2],b[2*(m-2)]=0,b[2*(m-2)+1]=0,g[3*(m-1)+0]=g[3*(m-2)+0]+l[0],g[3*(m-1)+1]=g[3*(m-2)+1]+l[1],g[3*(m-1)+2]=g[3*(m-2)+2]+l[2],b[2*(m-1)]=1,b[2*(m-1)+1]=1,_[3*(y-2)+0]=-c[0],_[3*(y-2)+1]=-c[1],_[3*(y-2)+2]=-c[2],_[3*(y-1)+0]=c[0],_[3*(y-1)+1]=c[1],_[3*(y-1)+2]=c[2]);for(var k=function(t,e,i){w[t]=e,x[t]=i},M=0,A=(0,a.c)(),j=(0,a.c)(),S=0;S<i;S++){var P=S*(2*Math.PI/i);(0,n.a)(A,v,Math.sin(P)),(0,n.a)(j,p,Math.cos(P)),(0,n.b)(A,A,j),_[3*S+0]=A[0],_[3*S+1]=A[1],_[3*S+2]=A[2],(0,n.a)(A,A,e),(0,n.b)(A,A,f),g[3*S+0]=A[0],g[3*S+1]=A[1],g[3*S+2]=A[2],b[2*S+0]=S/i,b[2*S+1]=0,g[3*(S+i)+0]=g[3*S+0]+l[0],g[3*(S+i)+1]=g[3*S+1]+l[1],g[3*(S+i)+2]=g[3*S+2]+l[2],b[2*(S+i)+0]=S/i,b[2*S+1]=1;var T=(S+1)%i;k(M++,S,S),k(M++,S+i,S),k(M++,T,T),k(M++,T,T),k(M++,S+i,S),k(M++,T+i,T)}if(s){for(var D=0;D<i;D++){var O=(D+1)%i;k(M++,m-2,y-2),k(M++,D,y-2),k(M++,O,y-2)}for(var Z=0;Z<i;Z++){var R=(Z+1)%i;k(M++,Z+i,y-1),k(M++,m-1,y-1),k(M++,R+i,y-1)}}return new d.Z([["position",{size:3,data:g,exclusive:!0}],["normal",{size:3,data:_,exclusive:!0}],["uv0",{size:2,data:b,exclusive:!0}]],[["position",w],["normal",x],["uv0",w]])},t.createTubeGeometry=function(e,i,r,n,a){r=r||10,n=null==n||n,(0,p.hu)(e.length>1);for(var o=[],s=[],u=0;u<r;u++){o.push([0,-u-1,-(u+1)%r-1]);var h=u/r*2*Math.PI;s.push([Math.cos(h)*i,Math.sin(h)*i])}return t.createPathExtrusionGeometry(s,e,[[0,0,0]],o,n,a)},t.createPathExtrusionGeometry=function(t,e,i,h,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:(0,a.f)(0,0,0),f=t.length,v=new Float32Array(e.length*f*3+(6*i.length||0)),p=new Float32Array(e.length*f*3+(i?6:0)),m=(e.length-1)*f*6+3*h.length*2,g=new Uint32Array(m),_=new Uint32Array(m),b=0,w=0,x=0,k=0,M=(0,a.c)(),A=(0,a.c)(),j=(0,a.c)(),S=(0,a.c)(),P=(0,a.c)(),T=(0,a.c)(),D=(0,a.c)(),O=(0,o.c)(),Z=(0,a.c)(),R=(0,a.c)(),C=(0,a.c)(),z=(0,a.c)(),U=(0,a.c)(),E=(0,s.Ue)();(0,n.s)(Z,0,1,0),(0,n.f)(A,e[1],e[0]),(0,n.n)(A,A),c?((0,n.b)(O,e[0],l),(0,n.n)(j,O)):(0,n.s)(j,0,0,1),r(A,j,Z,Z,P,j,y),(0,n.g)(S,j),(0,n.g)(z,P);for(var F=0;F<i.length;F++)(0,n.a)(T,P,i[F][0]),(0,n.a)(O,j,i[F][2]),(0,n.b)(T,T,O),(0,n.b)(T,T,e[0]),v[b++]=T[0],v[b++]=T[1],v[b++]=T[2];p[w++]=-A[0],p[w++]=-A[1],p[w++]=-A[2];for(var V=0;V<h.length;V++)g[x++]=h[V][0]>0?h[V][0]:-h[V][0]-1+i.length,g[x++]=h[V][1]>0?h[V][1]:-h[V][1]-1+i.length,g[x++]=h[V][2]>0?h[V][2]:-h[V][2]-1+i.length,_[k++]=0,_[k++]=0,_[k++]=0;for(var I=i.length,L=i.length-1,N=0;N<e.length;N++){var G=!1;N>0&&((0,n.g)(M,A),N<e.length-1?((0,n.f)(A,e[N+1],e[N]),(0,n.n)(A,A)):G=!0,(0,n.b)(R,M,A),(0,n.n)(R,R),(0,n.b)(C,e[N-1],S),(0,s.Yq)(e[N],R,E),(0,s.BR)(E,(0,u.re)(C,M),O)?((0,n.f)(O,O,e[N]),(0,n.n)(j,O),(0,n.c)(P,R,j),(0,n.n)(P,P)):r(R,S,z,Z,P,j,y),(0,n.g)(S,j),(0,n.g)(z,P)),c&&((0,n.b)(O,e[N],l),(0,n.n)(U,O));for(var W=0;W<f;W++)if((0,n.a)(T,P,t[W][0]),(0,n.a)(O,j,t[W][1]),(0,n.b)(T,T,O),(0,n.n)(D,T),p[w++]=D[0],p[w++]=D[1],p[w++]=D[2],(0,n.b)(T,T,e[N]),v[b++]=T[0],v[b++]=T[1],v[b++]=T[2],!G){var B=(W+1)%f;g[x++]=I+W,g[x++]=I+f+W,g[x++]=I+B,g[x++]=I+B,g[x++]=I+f+W,g[x++]=I+f+B;for(var q=0;q<6;q++)_[k++]=g[x-6+q]-L}I+=f}for(var H=e[e.length-1],X=0;X<i.length;X++)(0,n.a)(T,P,i[X][0]),(0,n.a)(O,j,i[X][1]),(0,n.b)(T,T,O),(0,n.b)(T,T,H),v[b++]=T[0],v[b++]=T[1],v[b++]=T[2];var J=w/3;p[w++]=A[0],p[w++]=A[1],p[w++]=A[2];for(var Y=I-f,$=0;$<h.length;$++)g[x++]=h[$][0]>=0?I+h[$][0]:-h[$][0]-1+Y,g[x++]=h[$][2]>=0?I+h[$][2]:-h[$][2]-1+Y,g[x++]=h[$][1]>=0?I+h[$][1]:-h[$][1]-1+Y,_[k++]=J,_[k++]=J,_[k++]=J;return new d.Z([["position",{size:3,data:v,exclusive:!0}],["normal",{size:3,data:p,exclusive:!0}]],[["position",g],["normal",_]])},t.createPolylineGeometry=function(t,e,i){(0,p.hu)(t.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),(0,p.hu)(3===t[0].length,"createPolylineGeometry(): malformed vertex"),(0,p.hu)(null==e||e.length===t.length,"createPolylineGeometry: need same number of points and normals"),(0,p.hu)(null==e||3===e[0].length,"createPolylineGeometry(): malformed normal");for(var r=new Float64Array(3*t.length),n=new Uint32Array(2*(t.length-1)),a=0,o=0,s=0;s<t.length;s++){for(var u=0;u<3;u++)r[a++]=t[s][u];s>0&&(n[o++]=s-1,n[o++]=s)}var h=[],c=[];if(h.push(["position",n]),c.push(["position",{size:3,data:r,exclusive:!0}]),e){for(var l=new Float32Array(3*e.length),f=0,m=0;m<t.length;m++)for(var y=0;y<3;y++)l[f++]=e[m][y];h.push(["normal",n]),c.push(["normal",{size:3,data:l,exclusive:!0}])}return i&&(c.push(["color",{size:4,data:i}]),h.push(["color",(0,v.p)(i.length/4)])),new d.Z(c,h,2)},t.createExtrudedTriangle=function(t,e,i,r){for(var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=new Array(18),o=[[-e,n,r/2],[i,n,r/2],[0,t+n,r/2],[-e,n,-r/2],[i,n,-r/2],[0,t+n,-r/2]],s=new Uint16Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5]),u=0;u<6;u++)a[3*u]=o[u][0],a[3*u+1]=o[u][1],a[3*u+2]=o[u][2];return new d.Z([["position",{size:3,data:a,exclusive:!0}]],[["position",s]])},t.transformInPlace=function(t,e){for(var i=t.getMutableAttribute("position").data,r=0;r<i.length;r+=3){var a=i[r],o=i[r+1],s=i[r+2];(0,n.s)(g,a,o,s),(0,n.m)(g,g,e),i[r]=g[0],i[r+1]=g[1],i[r+2]=g[2]}},t.cgToGIS=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=t.vertexAttributes,r=i.get("position").data,n=i.get("normal").data;if(n)for(var a=e.getMutableAttribute("normal").data,o=0;o<n.length;o+=3){var s=n[o+1];a[o+1]=-n[o+2],a[o+2]=s}if(r)for(var u=e.getMutableAttribute("position").data,h=0;h<r.length;h+=3){var c=r[h+1];u[h+1]=-r[h+2],u[h+2]=c}return e},t.makeOrthoBasisDirUp=i,t.makeOrthoBasisDirUpFallback=r}(f||(f={}));var y=.99619469809,g=(0,a.c)(),_=f},13679:function(t,e,i){i.d(e,{Z8:function(){return b},LP:function(){return k}});var r=i(37762),n=i(15671),a=i(43144),o=i(92026),s=i(14226),u=i(81949),h=i(11186),c=i(71353),l=i(90045),f=i(67077),d=i(40885),v=(0,a.Z)((function t(){(0,n.Z)(this,t),this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=2}));i(82218);function p(t){return(0,o.pC)(t)&&(0,o.pC)(t.dist)}(0,c.c)();var m=i(76783),y=i(32683),g=1e-5,_=function(){function t(e){(0,n.Z)(this,t),this.options=new v,this._results=new w,this.transform=new m.yn,this.tolerance=g,this.verticalOffset=null,this._ray=(0,d.Ue)(),this._rayEnd=(0,c.c)(),this._rayBeginTransformed=(0,c.c)(),this._rayEndTransformed=(0,c.c)(),this.viewingMode=null==e?1:e}return(0,a.Z)(t,[{key:"results",get:function(){return this._results}},{key:"ray",get:function(){return this._ray}},{key:"rayBegin",get:function(){return this._ray.origin}},{key:"rayEnd",get:function(){return this._rayEnd}},{key:"reset",value:function(t,e,i){this.resetWithRay((0,d.zk)(t,e,this._ray),i)}},{key:"resetWithRay",value:function(t,e){this.camera=e,t!==this._ray&&(0,d.JG)(t,this._ray),0!==this.options.verticalOffset?2===this.viewingMode?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,(0,h.b)(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}},{key:"intersect",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;this.point=i,this.filterPredicate=a,this.tolerance=null==n?g:n;var u=(0,m.W9)(this.verticalOffset);(0,o.pC)(e)&&e.length>0&&function(){var i,n=s?function(e){s(e)&&t.intersectObject(e)}:function(e){t.intersectObject(e)},a=(0,r.Z)(e);try{for(a.s();!(i=a.n()).done;){var h=i.value,c=h.getSpatialQueryAccelerator&&h.getSpatialQueryAccelerator();(0,o.pC)(c)?((0,o.pC)(u)?c.forEachAlongRayWithVerticalOffset(t._ray.origin,t._ray.direction,n,u):c.forEachAlongRay(t._ray.origin,t._ray.direction,n),t.options.selectionMode&&t.options.hud&&c.forEachDegenerateObject(n)):h.objects.forAll((function(t){return n(t)}))}}catch(l){a.e(l)}finally{a.f()}}(),this.sortResults()}},{key:"intersectObject",value:function(t){var e=this,i=t.geometryRecords;if(i){var n,a=t.transformation,s=(0,m.W9)(this.verticalOffset),c=(0,r.Z)(i);try{var l=function(){var i=n.value,r=i.geometry,c=i.material,l=i.instanceParameters;if((0,y.PD)(l))return"continue";var f=r.id;e.transform.setAndInvalidateLazyTransforms(a,i.getShaderTransformation()),(0,h.m)(e._rayBeginTransformed,e.rayBegin,e.transform.inverse),(0,h.m)(e._rayEndTransformed,e.rayEnd,e.transform.inverse);var d=e.transform.transform;(0,o.pC)(s)&&(s.objectTransform=e.transform),c.intersect(r,l,e.transform.transform,e,e._rayBeginTransformed,e._rayEndTransformed,(function(i,r,n,a,s,h){if(i>=0){if((0,o.pC)(e.filterPredicate)&&!e.filterPredicate(e._ray.origin,e._rayEnd,i))return;if(a){if(null==e._results.hud.dist||i<e._results.hud.dist){var c={object:t,geometryId:f,triangleNr:n,center:h};e._results.hud.set(1,c,i,r,u.I,s)}return}var l=function(e){return e.set(0,{object:t,geometryId:f,triangleNr:n},i,r,d,s)};if((null==e._results.min.drapedLayerOrder||s>=e._results.min.drapedLayerOrder)&&(null==e._results.min.dist||i<e._results.min.dist)&&l(e._results.min),0!==e.options.store&&(null==e._results.max.drapedLayerOrder||s<e._results.max.drapedLayerOrder)&&(null==e._results.max.dist||i>e._results.max.dist)&&l(e._results.max),2===e.options.store){var v=k(e._ray);v.set(0,{object:t,geometryId:f,triangleNr:n},i,r,d),e._results.all.push(v)}}}),i.shaderTransformation)};for(c.s();!(n=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}}}},{key:"sortResults",value:function(){this._results.all.sort((function(t,e){return t.dist!==e.dist?(0,o.Pt)(t.dist,0)-(0,o.Pt)(e.dist,0):t.drapedLayerOrder!==e.drapedLayerOrder?(0,o.Pt)(t.drapedLayerOrder,Number.MAX_VALUE)-(0,o.Pt)(e.drapedLayerOrder,Number.MAX_VALUE):(0,o.Pt)(e.drapedLayerGraphicOrder,Number.MIN_VALUE)-(0,o.Pt)(t.drapedLayerGraphicOrder,Number.MIN_VALUE)}))}}]),t}();function b(t){return new _(t)}var w=function(){function t(){(0,n.Z)(this,t),this._min=new x((0,d.Ue)()),this._max=new x((0,d.Ue)()),this._hud=new x((0,d.Ue)()),this._ground=new x((0,d.Ue)())}return(0,a.Z)(t,[{key:"min",get:function(){return this._min}},{key:"max",get:function(){return this._max}},{key:"hud",get:function(){return this._hud}},{key:"ground",get:function(){return this._ground}},{key:"init",value:function(t){this._min.init(t),this._max.init(t),this._hud.init(t),this._ground.init(t),this.all=[]}}]),t}(),x=function(){function t(e){(0,n.Z)(this,t),this.intersector=0,this.normal=(0,c.c)(),this.transformation=(0,u.c)(),this._ray=(0,d.Ue)(),this.init(e)}return(0,a.Z)(t,[{key:"ray",get:function(){return this._ray}},{key:"distanceInRenderSpace",get:function(){return(0,o.pC)(this.dist)?((0,h.a)(M,this.ray.direction,this.dist),(0,h.l)(M)):null}},{key:"getIntersectionPoint",value:function(t){return!!p(this)&&((0,h.a)(M,this.ray.direction,this.dist),(0,h.b)(t,this.ray.origin,M),!0)}},{key:"getTransformedNormal",value:function(t){return(0,h.g)(A,this.normal),A[3]=0,(0,l.t)(A,A,this.transformation),(0,h.g)(t,A),(0,h.n)(t,t)}},{key:"init",value:function(t){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=0,(0,d.JG)(t,this._ray)}},{key:"set",value:function(t,e,i,r,n,a,l){this.intersector=t,this.dist=i,(0,h.g)(this.normal,(0,o.Pt)(r,c.U)),(0,s.c)(this.transformation,(0,o.Pt)(n,u.I)),this.target=e,this.drapedLayerOrder=a,this.drapedLayerGraphicOrder=l}},{key:"copy",value:function(t){(0,d.JG)(t.ray,this._ray),this.intersector=t.intersector,this.dist=t.dist,this.target=t.target,this.drapedLayerOrder=t.drapedLayerOrder,this.drapedLayerGraphicOrder=t.drapedLayerGraphicOrder,(0,h.g)(this.normal,t.normal),(0,s.c)(this.transformation,t.transformation)}}]),t}();function k(t){return new x(t)}var M=(0,c.c)(),A=(0,f.c)()},59887:function(t,e,i){i.d(e,{T:function(){return x}});var r=i(37762),n=i(15671),a=i(43144),o=i(60136),s=i(29388),u=i(92026),h=i(14226),c=i(81949),l=i(11186),f=i(71353),d=i(23470),v=i(80064),p=i(1395),m=i(13005),y=i(95439),g=function(){function t(){(0,n.Z)(this,t),this._disposed=!1}return(0,a.Z)(t,[{key:"disposed",get:function(){return this._disposed}},{key:"shaderTransformation",get:function(){return this._shaderTransformation}},{key:"acquire",value:function(t,e,i,r,n,a){this.id=(0,y.D)(),this.geometry=t,this.material=e,this.transformation=i,this.instanceParameters=r,this.origin=n,this._shaderTransformation=a,this._disposed=!1}},{key:"release",value:function(){this._disposed=!1}},{key:"dispose",value:function(){this._disposed=!0}},{key:"getStaticTransformation",value:function(){return this.transformation}},{key:"getShaderTransformation",value:function(){return(0,u.pC)(this._shaderTransformation)?this._shaderTransformation(this.transformation):this.transformation}},{key:"computeAttachmentOrigin",value:function(t){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,t):this.geometry.computeAttachmentOrigin(t))&&((0,l.m)(t,t,this.getStaticTransformation()),!0)}}]),t}();g.pool=new m.Z(g);var _=i(47669),b=i(97731),w=i(32683),x=function(t){(0,o.Z)(i,t);var e=(0,s.Z)(i);function i(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.Z)(this,i),(t=e.call(this)).type=1,t._geometryRecords=new Array,t._geometries=new Array,t._objectTransformation=(0,c.c)(),t._bvObjectSpace=new M,t._bvWorldSpace=new M,t._bvDirty=!0,t._hasVolatileTransformation=!1,t._visible=!0,t.castShadow=null==r.castShadow||r.castShadow,t.metadata=r.metadata,t.metadata&&t.metadata.isElevationSource&&(t.metadata.lastValidElevationBB=new k),t.transformation=(0,c.c)();var a=r.geometries,o=r.materials,s=r.transformations,u=r.origins;if(Array.isArray(a)){(0,b.hu)(o.length===a.length,"Object3D: materials don't match geometries"),(0,b.hu)(s.length===a.length,"Object3D: transformations don't match geometries"),t._geometryRecords.length=a.length,t._geometries.length=a.length;for(var h=0;h<a.length;h++)t._geometries[h]=a[h],t._geometryRecords[h]=g.pool.acquire(a[h],o[h],(0,c.b)(s[h]),{highlights:null,occludees:null,visible:t._visible},u&&u[h])}return t}return(0,a.Z)(i,[{key:"geometryRecords",get:function(){return this._geometryRecords}},{key:"geometries",get:function(){return this._geometries}},{key:"transformation",get:function(){return this._objectTransformation},set:function(t){(0,h.c)(this._objectTransformation,t),this._invalidateBoundingVolume(),this._emit("objectTransformation",this)}},{key:"dispose",value:function(){this._geometryRecords.length=0,this._geometries.length=0}},{key:"parentLayer",get:function(){return this._parentLayer},set:function(t){(0,b.hu)(null==this._parentLayer||null==t,"Object3D can only be added to a single Layer"),this._parentLayer=t}},{key:"addGeometry",value:function(t,e,i,r,n){i=i||c.I,this._geometries.push(t);var a=g.pool.acquire(t,e,i,{highlights:null,occludees:null,visible:this._visible},r,n);return this._geometryRecords.push(a),this._hasVolatileTransformation=this._hasVolatileTransformation||(0,u.pC)(a.shaderTransformation),this._emit("objectGeometryAdded",{object:this,record:a}),this._invalidateBoundingVolume(),a}},{key:"removeGeometry",value:function(t){var e=this._geometryRecords.splice(t,1)[0];return this._hasVolatileTransformation=(0,u.pC)(e.shaderTransformation)?this._geometryRecords.some((function(t){return(0,u.pC)(t.shaderTransformation)})):this._hasVolatileTransformation,e.dispose(),this._geometries.splice(t,1),this._emit("objectGeometryRemoved",{object:this,record:e}),this._invalidateBoundingVolume(),e}},{key:"removeAllGeometries",value:function(){for(;this.geometryRecords.length>0;)this.removeGeometry(0)}},{key:"geometryVertexAttrsUpdated",value:function(t){this._emit("vertexAttrsUpdated",{object:this,record:t}),this._invalidateBoundingVolume()}},{key:"isVisible",get:function(){return this._visible}},{key:"setVisible",value:function(t){if(this._visible!==t){this._visible=t;var e,i=(0,r.Z)(this._geometryRecords);try{for(i.s();!(e=i.n()).done;){e.value.instanceParameters.visible=this._visible}}catch(n){i.e(n)}finally{i.f()}this._emit("visibilityChanged",this)}}},{key:"maskOccludee",value:function(){var t,e=new _.O(1),i=(0,r.Z)(this._geometryRecords);try{for(i.s();!(t=i.n()).done;){var n=t.value;n.instanceParameters.occludees=(0,w.lr)(n.instanceParameters.occludees,e)}}catch(a){i.e(a)}finally{i.f()}return this._emit("occlusionChanged",this),e}},{key:"removeOcclude",value:function(t){var e,i=(0,r.Z)(this._geometryRecords);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.instanceParameters.occludees=(0,w.U_)(n.instanceParameters.occludees,t)}}catch(a){i.e(a)}finally{i.f()}this._emit("occlusionChanged",this)}},{key:"highlight",value:function(){var t,e=new _.O(0),i=(0,r.Z)(this._geometryRecords);try{for(i.s();!(t=i.n()).done;){var n=t.value;n.instanceParameters.highlights=(0,w.lr)(n.instanceParameters.highlights,e)}}catch(a){i.e(a)}finally{i.f()}return this._emit("highlightChanged",this),e}},{key:"removeHighlight",value:function(t){var e,i=(0,r.Z)(this._geometryRecords);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.instanceParameters.highlights=(0,w.U_)(n.instanceParameters.highlights,t)}}catch(a){i.e(a)}finally{i.f()}this._emit("highlightChanged",this)}},{key:"getCombinedStaticTransformation",value:function(t,e){return(0,h.m)((0,u.Pt)(e,(0,c.c)()),this.transformation,t.getStaticTransformation())}},{key:"getCombinedShaderTransformation",value:function(t,e){return e=e||(0,c.c)(),(0,h.m)(e,this.transformation,t.getShaderTransformation()),e}},{key:"hasVolativeTransformation",value:function(){return this._hasVolatileTransformation}},{key:"boundingVolumeWorldSpace",get:function(){return this._validateBoundingVolume(),this._bvWorldSpace}},{key:"boundingVolumeObjectSpace",get:function(){return this._validateBoundingVolume(),this._bvObjectSpace}},{key:"_validateBoundingVolume",value:function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init(),this._bvWorldSpace.init();for(var t=0;t<this._geometryRecords.length;++t){var e=this._geometries[t],i=this._geometryRecords[t],r=e.boundingInfo;(0,u.pC)(r)&&(this._calculateTransformedBoundingVolume(r,this._bvObjectSpace,i.getShaderTransformation()),this._calculateTransformedBoundingVolume(r,this._bvWorldSpace,this.getCombinedShaderTransformation(i)))}(0,l.e)(this._bvObjectSpace.bounds,this._bvObjectSpace.min,this._bvObjectSpace.max,.5),(0,l.e)(this._bvWorldSpace.bounds,this._bvWorldSpace.min,this._bvWorldSpace.max,.5);for(var n=(0,f.c)(),a=(0,f.c)(),o=(0,v.u1)(this.transformation),s=0;s<this._geometryRecords.length;++s){var h=this._geometries[s].boundingInfo;if(!(0,u.Wi)(h)){var c=this._geometryRecords[s].getShaderTransformation(),d=(0,v.u1)(c);(0,l.m)(n,h.getCenter(),c);var p=(0,l.i)(n,this._bvObjectSpace.bounds),m=h.getBSRadius()*d;this._bvObjectSpace.bounds[3]=Math.max(this._bvObjectSpace.bounds[3],p+m),(0,l.m)(a,n,this.transformation);var y=(0,l.i)(a,this._bvWorldSpace.bounds),g=m*o;this._bvWorldSpace.bounds[3]=Math.max(this._bvWorldSpace.bounds[3],y+g)}}this._bvDirty=!1}}},{key:"_calculateTransformedBoundingVolume",value:function(t,e,i){var r=t.getBBMin(),n=t.getBBMax(),a=(0,f.a)(r),o=(0,f.a)(n);(0,l.m)(a,a,i),(0,l.m)(o,o,i);for(var s=0;s<3;++s)e.min[s]=Math.min(e.min[s],a[s],o[s]),e.max[s]=Math.max(e.max[s],a[s],o[s]);for(var u=0;u<3;++u){(0,l.g)(a,r),(0,l.g)(o,n),a[u]=n[u],o[u]=r[u],(0,l.m)(a,a,i),(0,l.m)(o,o,i);for(var h=0;h<3;++h)e.min[h]=Math.min(e.min[h],a[h],o[h]),e.max[h]=Math.max(e.max[h],a[h],o[h])}}},{key:"_invalidateBoundingVolume",value:function(){this._bvDirty=!0,(0,u.pC)(this._parentLayer)&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace.bounds)}},{key:"_emit",value:function(t,e){(0,u.pC)(this._parentLayer)&&this._parentLayer.events.emit(t,e)}},{key:"test",get:function(){var t=this;return{hasGeometry:function(e){return t._geometries.indexOf(e)>-1},getGeometryIndex:function(e){return t._geometries.indexOf(e)}}}}]),i}(p.c),k=function(){function t(){(0,n.Z)(this,t),this.min=(0,f.f)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.max=(0,f.f)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}return(0,a.Z)(t,[{key:"isEmpty",value:function(){return this.max[0]<this.min[0]&&this.max[1]<this.min[1]&&this.max[2]<this.min[2]}}]),t}(),M=function(t){(0,o.Z)(i,t);var e=(0,s.Z)(i);function i(){var t;return(0,n.Z)(this,i),(t=e.apply(this,arguments)).bounds=(0,d.c)(),t}return(0,a.Z)(i,[{key:"init",value:function(){(0,l.s)(this.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),(0,l.s)(this.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),(0,d.a)(this.bounds)}}]),i}(k)},47669:function(t,e,i){i.d(e,{O:function(){return o}});var r=i(43144),n=i(15671),a=i(95439),o=(0,r.Z)((function t(e){(0,n.Z)(this,t),this.channel=e,this.id=(0,a.D)()}))},78329:function(t,e,i){i.d(e,{Z:function(){return p}});var r=i(37762),n=i(15671),a=i(43144),o=i(92026),s=i(13005),u=i(27546),h=i(11186),c=i(71353),l=i(95773),f=i(40885),d=i(23470),v=i(97731),p=function(){function t(e,i){(0,n.Z)(this,t),this._objectToBoundingSphere=e,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new m,this._objectCount=0,i&&(void 0!==i.maximumObjectsPerNode&&(this._maximumObjectsPerNode=i.maximumObjectsPerNode),void 0!==i.maximumDepth&&(this._maximumDepth=i.maximumDepth))}return(0,a.Z)(t,[{key:"bounds",get:function(){return this._root.bounds}},{key:"halfSize",get:function(){return this._root.halfSize}},{key:"root",get:function(){return this._root.node}},{key:"maximumObjectsPerNode",get:function(){return this._maximumObjectsPerNode}},{key:"maximumDepth",get:function(){return this._maximumDepth}},{key:"objectCount",get:function(){return this._objectCount}},{key:"destroy",value:function(){this._degenerateObjects.clear(),m.clearPool(),P[0]=null,R.prune(),V.prune()}},{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;this._objectCount+=e,this._grow(t,e);for(var i=m.acquire(),r=0;r<e;r++){var n=t[r];this._isDegenerate(n)?this._degenerateObjects.add(n):(i.init(this._root),this._add(n,i))}m.release(i)}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._objectCount-=t.length;var i,n=m.acquire(),a=(0,r.Z)(t);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=(0,o.pC)(e)?e:(0,d.b)(this._objectToBoundingSphere(s),C);M(u[3])?(n.init(this._root),this._remove(s,u,n)):this._degenerateObjects.delete(s)}}catch(h){a.e(h)}finally{a.f()}m.release(n),this._shrink()}},{key:"update",value:function(t,e){if(M(e[3])||!this._isDegenerate(t)){var i=function(t){return P[0]=t,P}(t);this.remove(i,e),this.add(i)}}},{key:"forEachAlongRay",value:function(t,e,i){var r=this,n=(0,f.re)(t,e);this._forEachNode(this._root,(function(t){if(!r._intersectsNode(n,t))return!1;var e=t.node;return e.terminals.forAll((function(t){r._intersectsObject(n,t)&&i(t)})),null!==e.residents&&e.residents.forAll((function(t){r._intersectsObject(n,t)&&i(t)})),!0}))}},{key:"forEachAlongRayWithVerticalOffset",value:function(t,e,i,r){var n=this,a=(0,f.re)(t,e);this._forEachNode(this._root,(function(t){if(!n._intersectsNodeWithOffset(a,t,r))return!1;var e=t.node;return e.terminals.forAll((function(t){n._intersectsObjectWithOffset(a,t,r)&&i(t)})),null!==e.residents&&e.residents.forAll((function(t){n._intersectsObjectWithOffset(a,t,r)&&i(t)})),!0}))}},{key:"forEach",value:function(t){this._forEachNode(this._root,(function(e){var i=e.node;return i.terminals.forAll(t),null!==i.residents&&i.residents.forAll(t),!0})),this._degenerateObjects.forEach(t)}},{key:"forEachDegenerateObject",value:function(t){this._degenerateObjects.forEach(t)}},{key:"findClosest",value:function(t,e,i){var r=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,o=1/0,s=1/0,u=null,c=x(t,e),f=function(h){if(--a,n(h)){var c=r._objectToBoundingSphere(h);if((0,l.hr)(i,c)){var f=k(t,e,(0,d.g)(c)),v=f-c[3],p=f+c[3];v<o&&(o=v,s=p,u=h)}}};return this._forEachNodeDepthOrdered(this._root,(function(r){if(a<=0||!(0,l.hr)(i,r.bounds))return!1;if((0,h.a)(D,c,r.halfSize),(0,h.b)(D,D,r.bounds),k(t,e,D)>s)return!1;var n=r.node;return n.terminals.forAll((function(t){return f(t)})),null!==n.residents&&n.residents.forAll((function(t){return f(t)})),!0}),t,e),u}},{key:"forEachInDepthRange",value:function(t,e,i,r,n,a,o){var s=this,u=-1/0,c=1/0,f={setRange:function(t){1===i?(u=Math.max(u,t.near),c=Math.min(c,t.far)):(u=Math.max(u,-t.far),c=Math.min(c,-t.near))}};f.setRange(r);var v=k(e,i,t),p=x(e,i),m=x(e,-i),y=function(t){if(o(t)){var r=s._objectToBoundingSphere(t),h=(0,d.g)(r),p=k(e,i,h)-v,m=p-r[3],y=p+r[3];m>c||y<u||!(0,l.hr)(a,r)||n(t,f)}};this._forEachNodeDepthOrdered(this._root,(function(t){if(!(0,l.hr)(a,t.bounds))return!1;if((0,h.a)(D,p,t.halfSize),(0,h.b)(D,D,t.bounds),k(e,i,D)-v>c)return!1;if((0,h.a)(D,m,t.halfSize),(0,h.b)(D,D,t.bounds),k(e,i,D)-v<u)return!1;var r=t.node;return r.terminals.forAll((function(t){return y(t)})),null!==r.residents&&r.residents.forAll((function(t){return y(t)})),!0}),e,i)}},{key:"forEachNode",value:function(t){this._forEachNode(this._root,(function(e){return t(e.node,e.bounds,e.halfSize)}))}},{key:"_intersectsNode",value:function(t,e){return _(e.bounds,2*-e.halfSize,O),_(e.bounds,2*e.halfSize,Z),(0,v.yK)(t.origin,t.direction,O,Z)}},{key:"_intersectsNodeWithOffset",value:function(t,e,i){return _(e.bounds,2*-e.halfSize,O),_(e.bounds,2*e.halfSize,Z),i.applyToMinMax(O,Z),(0,v.yK)(t.origin,t.direction,O,Z)}},{key:"_intersectsObject",value:function(t,e){var i=this._objectToBoundingSphere(e);return!(i[3]>0)||(0,d.i)(i,t)}},{key:"_intersectsObjectWithOffset",value:function(t,e,i){var r=this._objectToBoundingSphere(e);return!(r[3]>0)||(0,d.i)(i.applyToBoundingSphere(r),t)}},{key:"_forEachNode",value:function(t,e){for(var i=m.acquire().init(t),r=[i];0!==r.length;){if(e(i=r.pop())&&!i.isLeaf())for(var n=0;n<i.node.children.length;n++)i.node.children[n]&&r.push(m.acquire().init(i).advance(n));m.release(i)}}},{key:"_forEachNodeDepthOrdered",value:function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=m.acquire().init(t),a=[n];for(w(i,r,I);0!==a.length;){if(e(n=a.pop())&&!n.isLeaf())for(var o=7;o>=0;--o){var s=I[o];n.node.children[s]&&a.push(m.acquire().init(n).advance(s))}m.release(n)}}},{key:"_remove",value:function(t,e,i){R.clear();var r=i.advanceTo(e,(function(t,e){R.push(t.node),R.push(e)}))?i.node.terminals:i.node.residents;if(r.removeUnordered(t),0===r.length)for(var n=R.length-2;n>=0;n-=2){var a=R.data[n],o=R.data[n+1];if(!this._purge(a,o))break}}},{key:"_nodeIsEmpty",value:function(t){if(0!==t.terminals.length)return!1;if(null!==t.residents)return 0===t.residents.length;for(var e=0;e<t.children.length;e++)if(t.children[e])return!1;return!0}},{key:"_purge",value:function(t,e){return e>=0&&(t.children[e]=null),!!this._nodeIsEmpty(t)&&(null===t.residents&&(t.residents=new u.Z({shrink:!0})),!0)}},{key:"_add",value:function(t,e){e.advanceTo(this._objectToBoundingSphere(t))?e.node.terminals.push(t):(e.node.residents.push(t),e.node.residents.length>this._maximumObjectsPerNode&&e.depth<this._maximumDepth&&this._split(e))}},{key:"_split",value:function(t){var e=t.node.residents;t.node.residents=null;for(var i=0;i<e.length;i++){var r=m.acquire().init(t);this._add(e.getItemAt(i),r),m.release(r)}}},{key:"_grow",value:function(t,e){var i=this;if(0!==e&&(b(t,e,(function(t){return i._objectToBoundingSphere(t)}),z),M(z[3])&&!this._fitsInsideTree(z)))if(this._nodeIsEmpty(this._root.node))(0,d.b)(z,this._root.bounds),this._root.halfSize=1.25*z[3];else{var r=this._rootBoundsForRootAsSubNode(z);this._placingRootViolatesMaxDepth(r)?this._rebuildTree(z,r):this._growRootAsSubNode(r),m.release(r)}}},{key:"_rebuildTree",value:function(t,e){var i=this;(0,h.g)(U,e.bounds),U[3]=e.halfSize,b([t,U],2,(function(t){return t}),E);var r=m.acquire().init(this._root);this._root.initFrom(null,E,1.25*E[3]),this._forEachNode(r,(function(t){return i.add(t.node.terminals.data,t.node.terminals.length),null!==t.node.residents&&i.add(t.node.residents.data,t.node.residents.length),!0})),m.release(r)}},{key:"_placingRootViolatesMaxDepth",value:function(t){var e=this,i=Math.log(t.halfSize/this._root.halfSize)*Math.LOG2E,r=0;return this._forEachNode(this._root,(function(t){return(r=Math.max(r,t.depth))+i<=e._maximumDepth})),r+i>this._maximumDepth}},{key:"_rootBoundsForRootAsSubNode",value:function(t){for(var e=t[3],i=t,r=-1/0,n=this._root.bounds,a=this._root.halfSize,o=0;o<3;o++){var s=n[o]-a-(i[o]-e),u=i[o]+e-(n[o]+a),h=Math.max(0,Math.ceil(s/(2*a))),c=Math.max(0,Math.ceil(u/(2*a)))+1,l=Math.pow(2,Math.ceil(Math.log(h+c)*Math.LOG2E));r=Math.max(r,l),F[o].min=h,F[o].max=c}for(var f=0;f<3;f++){var d=F[f].min,v=F[f].max,p=(r-(d+v))/2;d+=Math.ceil(p),v+=Math.floor(p);var y=n[f]-a-d*a*2;T[f]=y+(v+d)*a}return T[3]=r*a*S,m.acquire().initFrom(null,T,r*a,0)}},{key:"_growRootAsSubNode",value:function(t){var e=this._root.node;(0,h.g)(z,this._root.bounds),z[3]=this._root.halfSize,this._root.init(t),t.advanceTo(z,null,!0),t.node.children=e.children,t.node.residents=e.residents,t.node.terminals=e.terminals}},{key:"_shrink",value:function(){for(;;){var t=this._findShrinkIndex();if(-1===t)break;this._root.advance(t),this._root.depth=0}}},{key:"_findShrinkIndex",value:function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var t=null,e=this._root.node.children,i=0,r=0;r<e.length&&null==t;)t=e[i=r++];for(;r<e.length;)if(e[r++])return-1;return i}},{key:"_isDegenerate",value:function(t){return!M(this._objectToBoundingSphere(t)[3])}},{key:"_fitsInsideTree",value:function(t){var e=this._root.bounds,i=this._root.halfSize;return t[3]<=i&&t[0]>=e[0]-i&&t[0]<=e[0]+i&&t[1]>=e[1]-i&&t[1]<=e[1]+i&&t[2]>=e[2]-i&&t[2]<=e[2]+i}}]),t}(),m=function(){function t(){(0,n.Z)(this,t),this.bounds=(0,d.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}return(0,a.Z)(t,[{key:"init",value:function(t){return this.initFrom(t.node,t.bounds,t.halfSize,t.depth)}},{key:"initFrom",value:function(e,i,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.depth;return this.node=(0,o.pC)(e)?e:t.createEmptyNode(),(0,o.pC)(i)&&(0,d.b)(i,this.bounds),this.halfSize=r,this.depth=n,this}},{key:"advance",value:function(e){var i=this.node.children[e];i||(i=t.createEmptyNode(),this.node.children[e]=i),this.node=i,this.halfSize/=2,this.depth++;var r=A[e];return this.bounds[0]+=r[0]*this.halfSize,this.bounds[1]+=r[1]*this.halfSize,this.bounds[2]+=r[2]*this.halfSize,this.bounds[3]=this.halfSize*S,this}},{key:"advanceTo",value:function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];;){if(this.isTerminalFor(t))return e&&e(this,-1),!0;if(this.isLeaf()){if(!i)return e&&e(this,-1),!1;this.node.residents=null}var r=this._childIndex(t);e&&e(this,r),this.advance(r)}}},{key:"isLeaf",value:function(){return null!=this.node.residents}},{key:"isTerminalFor",value:function(t){return t[3]>this.halfSize/2}},{key:"_childIndex",value:function(t){var e=this.bounds;return(e[0]<t[0]?1:0)+(e[1]<t[1]?2:0)+(e[2]<t[2]?4:0)}}],[{key:"createEmptyNode",value:function(){return{children:[null,null,null,null,null,null,null,null],terminals:new u.Z({shrink:!0}),residents:new u.Z({shrink:!0})}}},{key:"acquire",value:function(){return t._pool.acquire()}},{key:"release",value:function(e){t._pool.release(e)}},{key:"clearPool",value:function(){t._pool.prune()}}]),t}();function y(t,e){t[0]=Math.min(t[0],e[0]-e[3]),t[1]=Math.min(t[1],e[1]-e[3]),t[2]=Math.min(t[2],e[2]-e[3])}function g(t,e){t[0]=Math.max(t[0],e[0]+e[3]),t[1]=Math.max(t[1],e[1]+e[3]),t[2]=Math.max(t[2],e[2]+e[3])}function _(t,e,i){i[0]=t[0]+e,i[1]=t[1]+e,i[2]=t[2]+e}function b(t,e,i,r){if(1===e){var n=i(t[0]);(0,d.b)(n,r)}else{O[0]=1/0,O[1]=1/0,O[2]=1/0,Z[0]=-1/0,Z[1]=-1/0,Z[2]=-1/0;for(var a=0;a<e;a++){var o=i(t[a]);M(o[3])&&(y(O,o),g(Z,o))}(0,h.e)(r,O,Z,.5),r[3]=Math.max(Z[0]-O[0],Z[1]-O[1],Z[2]-O[2])/2}}function w(t,e,i){if(!V.length)for(var r=0;r<8;++r)V.push({index:0,distance:0});for(var n=0;n<8;++n){var a=A[n];V.data[n].index=n,V.data[n].distance=k(t,e,a)}V.sort((function(t,e){return t.distance-e.distance}));for(var o=0;o<8;++o)i[o]=V.data[o].index}function x(t,e){for(var i=1/0,r=null,n=0;n<8;++n){var a=k(t,e,j[n]);a<i&&(i=a,r=j[n])}return r}function k(t,e,i){return e*(t[0]*i[0]+t[1]*i[1]+t[2]*i[2])}function M(t){return!isNaN(t)&&t!==-1/0&&t!==1/0&&t>0}m._pool=new s.Z(m);var A=[(0,c.f)(-1,-1,-1),(0,c.f)(1,-1,-1),(0,c.f)(-1,1,-1),(0,c.f)(1,1,-1),(0,c.f)(-1,-1,1),(0,c.f)(1,-1,1),(0,c.f)(-1,1,1),(0,c.f)(1,1,1)],j=[(0,c.f)(-1,-1,-1),(0,c.f)(-1,-1,1),(0,c.f)(-1,1,-1),(0,c.f)(-1,1,1),(0,c.f)(1,-1,-1),(0,c.f)(1,-1,1),(0,c.f)(1,1,-1),(0,c.f)(1,1,1)],S=Math.sqrt(3),P=[null];var T=(0,d.c)(),D=(0,c.c)(),O=(0,c.c)(),Z=(0,c.c)(),R=new u.Z,C=(0,d.c)(),z=(0,d.c)(),U=(0,d.c)(),E=(0,d.c)(),F=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],V=new u.Z,I=[0,0,0,0,0,0,0,0]},97882:function(t,e,i){i.d(e,{F:function(){return p}});var r=i(37762),n=i(15671),a=i(43144),o=i(60136),s=i(29388),u=i(91505),h=i(100),c=i(92026),l=i(27546),f=i(1395),d=["layerObjectAdded","layerObjectRemoved","layerObjectsAdded","layerObjectsRemoved","shaderTransformationChanged","objectTransformation","visibilityChanged","occlusionChanged","highlightChanged","objectGeometryAdded","objectGeometryRemoved","vertexAttrsUpdated"],v=i(78329),p=function(t){(0,o.Z)(i,t);var e=(0,s.Z)(i);function i(t){var r,a,o,s,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,n.Z)(this,i),(r=e.call(this)).apiLayerUid=c,r.type=0,r.events=new u.Z,r.isSliceable=!1,r._objects=new l.Z,r._stageHandles=new h.Z,r.apiLayerUid=c,r.isVisible=null==(a=null==t?void 0:t.isVisible)||a,r.isPickable=null==(o=null==t?void 0:t.isPickable)||o,r.updatePolicy=null!=(s=null==t?void 0:t.updatePolicy)?s:0,r}return(0,a.Z)(i,[{key:"objects",get:function(){return this._objects}},{key:"destroy",value:function(){this.detachStage(),this._stage=null}},{key:"attachStage",value:function(t){var e=this;this.detachStage(),this._stage=t;var i,n=(0,r.Z)(d);try{var a=function(){var r=i.value;e._stageHandles.add(e.events.on(r,(function(e){return t.handleEvent(r,e)})))};for(n.s();!(i=n.n()).done;)a()}catch(o){n.e(o)}finally{n.f()}}},{key:"detachStage",value:function(){this._stageHandles.removeAll(),this.invalidateSpatialQueryAccelerator()}},{key:"add",value:function(t){this._objects.push(t),t.parentLayer=this,this.events.emit("layerObjectAdded",{layer:this,object:t}),(0,c.pC)(this._octree)&&this._octree.add([t])}},{key:"remove",value:function(t){this._objects.removeUnordered(t)&&(t.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:t}),(0,c.pC)(this._octree)&&this._octree.remove([t]))}},{key:"addMany",value:function(t){this._objects.pushArray(t);var e,i=(0,r.Z)(t);try{for(i.s();!(e=i.n()).done;){e.value.parentLayer=this}}catch(n){i.e(n)}finally{i.f()}this.events.emit("layerObjectsAdded",{layer:this,objects:t}),(0,c.pC)(this._octree)&&this._octree.add(t)}},{key:"removeMany",value:function(t){var e=new Array;if(this._objects.removeUnorderedMany(t,t.length,e),0!==e.length){var i,n=(0,r.Z)(e);try{for(n.s();!(i=n.n()).done;){i.value.parentLayer=null}}catch(a){n.e(a)}finally{n.f()}this.events.emit("layerObjectsRemoved",{layer:this,objects:e}),(0,c.pC)(this._octree)&&this._octree.remove(e)}}},{key:"sync",value:function(){(0,c.pC)(this._stage)&&1!==this.updatePolicy&&this._stage.syncLayer(this.id)}},{key:"notifyObjectBBChanged",value:function(t,e){(0,c.pC)(this._octree)&&this._octree.update(t,e)}},{key:"getSpatialQueryAccelerator",value:function(){return(0,c.Wi)(this._octree)&&this._objects.length>50&&this._createOctree(),this._octree}},{key:"shaderTransformationChanged",value:function(){this.invalidateSpatialQueryAccelerator(),this.events.emit("shaderTransformationChanged",this)}},{key:"invalidateSpatialQueryAccelerator",value:function(){this._octree=(0,c.SC)(this._octree)}},{key:"_createOctree",value:function(){this._octree=new v.Z((function(t){return t.boundingVolumeWorldSpace.bounds})),this._octree.add(this._objects.data,this._objects.length)}}]),i}(f.c)},74818:function(t,e,i){i.d(e,{E:function(){return Z}});var r=i(1413),n=i(15671),a=i(43144),o=i(60136),s=i(29388),u=i(23620),h=i(94425),c=i(56529),l=i(78041),f=i(64226),d=i(22909),v=i(11752),p=i(61120),m=i(27366),y=i(33280),g=i(137),_=i(15226),b=i(41012),w=i(82144),x=i(31132),k=i(33559),M=i(7566),A=i(27627),j=i(50411),S=i(45028),P=i(36207),T=function(t){(0,o.Z)(i,t);var e=(0,s.Z)(i);function i(){return(0,n.Z)(this,i),e.apply(this,arguments)}return(0,a.Z)(i,[{key:"initializeProgram",value:function(t){var e=i.shader.get(),r=this.configuration,n=e.build({output:r.output,OITEnabled:0===r.transparencyPassType,attributeColor:r.vertexColors,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new A.$(t.rctx,n,M.i)}},{key:"bindPass",value:function(t,e){(0,b.II)(this.program,e.camera.projectionMatrix),this.program.setUniform4fv("eColor",t.color),4===this.configuration.output&&(0,g.wW)(this.program,e),(1===this.configuration.output||e.multipassTerrainEnabled)&&this.program.setUniform2fv("cameraNearFar",e.camera.nearFar),e.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",e.inverseViewport),(0,_.p)(this.program,e))}},{key:"bindDraw",value:function(t){(0,b.id)(this.program,t),this.program.rebindTextures(),(0,y.DA)(this.program,this.configuration,t)}},{key:"createPipeline",value:function(t,e){var i=this.configuration,r=3===t,n=2===t;return(0,P.sm)({blending:0!==i.output&&7!==i.output||!i.transparent?null:r?l.wu:(0,l.$L)(t),culling:(0,P.zp)(i.cullFace),depthTest:{func:(0,l.$x)(t)},depthWrite:r||n?i.writeDepth&&P.LZ:null,colorWrite:P.BK,stencilWrite:i.sceneHasOcludees?j.s3:null,stencilTest:i.sceneHasOcludees?e?j.eD:j.RY:null,polygonOffset:r||n?i.polygonOffset&&D:(0,l.je)(i.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this.createPipeline(this.configuration.transparencyPassType,!0),this.createPipeline(this.configuration.transparencyPassType,!1)}},{key:"getPipelineState",value:function(t,e){return e?this._occludeePipelineState:(0,v.Z)((0,p.Z)(i.prototype),"getPipelineState",this).call(this,t,e)}}]),i}(x.A);T.shader=new w.J(S.C,(function(){return i.e(3173).then(i.bind(i,23173))}));var D={factor:1,units:1},O=function(t){(0,o.Z)(i,t);var e=(0,s.Z)(i);function i(){var t;return(0,n.Z)(this,i),(t=e.apply(this,arguments)).output=0,t.cullFace=0,t.slicePlaneEnabled=!1,t.vertexColors=!1,t.transparent=!1,t.polygonOffset=!1,t.enableOffset=!0,t.writeDepth=!0,t.sceneHasOcludees=!1,t.transparencyPassType=3,t.multipassTerrainEnabled=!1,t.cullAboveGround=!1,t}return(0,a.Z)(i)}(k.m);(0,m._)([(0,k.o)({count:8})],O.prototype,"output",void 0),(0,m._)([(0,k.o)({count:3})],O.prototype,"cullFace",void 0),(0,m._)([(0,k.o)()],O.prototype,"slicePlaneEnabled",void 0),(0,m._)([(0,k.o)()],O.prototype,"vertexColors",void 0),(0,m._)([(0,k.o)()],O.prototype,"transparent",void 0),(0,m._)([(0,k.o)()],O.prototype,"polygonOffset",void 0),(0,m._)([(0,k.o)()],O.prototype,"enableOffset",void 0),(0,m._)([(0,k.o)()],O.prototype,"writeDepth",void 0),(0,m._)([(0,k.o)()],O.prototype,"sceneHasOcludees",void 0),(0,m._)([(0,k.o)({count:4})],O.prototype,"transparencyPassType",void 0),(0,m._)([(0,k.o)()],O.prototype,"multipassTerrainEnabled",void 0),(0,m._)([(0,k.o)()],O.prototype,"cullAboveGround",void 0);var Z=function(t){(0,o.Z)(i,t);var e=(0,s.Z)(i);function i(t){var r;return(0,n.Z)(this,i),(r=e.call(this,t,C)).supportsEdges=!0,r.techniqueConfig=new O,r}return(0,a.Z)(i,[{key:"getTechniqueConfig",value:function(t,e){return this.techniqueConfig.output=t,this.techniqueConfig.cullFace=this.parameters.cullFace,this.techniqueConfig.vertexColors=this.parameters.vertexColors,this.techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.polygonOffset=this.parameters.polygonOffset,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.sceneHasOcludees=this.parameters.sceneHasOcludees,this.techniqueConfig.transparencyPassType=e.transparencyPassType,this.techniqueConfig.enableOffset=e.camera.relativeElevation<l.ve,this.techniqueConfig.multipassTerrainEnabled=e.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=e.cullAboveGround,this.techniqueConfig}},{key:"getPassParameters",value:function(){return this.parameters}},{key:"intersect",value:function(t,e,i,r,n,a,o){(0,d.Bw)(t,e,r,n,a,void 0,o)}},{key:"requiresSlot",value:function(t,e){return 20===t||(4===(0,h.S)(e)?2===t:t===(this.parameters.transparent?this.parameters.writeDepth?4:7:2))}},{key:"createGLMaterial",value:function(t){return 0===t.output||7===t.output||4===t.output||1===t.output&&this.parameters.writeLinearDepth?new R(t):null}},{key:"createBufferWriter",value:function(){return new f.G_(f.IM)}}]),i}(c.F),R=function(t){(0,o.Z)(i,t);var e=(0,s.Z)(i);function i(){return(0,n.Z)(this,i),e.apply(this,arguments)}return(0,a.Z)(i,[{key:"updateParameters",value:function(t){return this.ensureTechnique(T,t)}},{key:"_updateOccludeeState",value:function(t){t.hasOccludees!==this._material.parameters.sceneHasOcludees&&this._material.setParameters({sceneHasOcludees:t.hasOccludees})}},{key:"beginSlot",value:function(t){return 0!==this._output&&7!==this._output||this._updateOccludeeState(t),this.updateParameters(t)}},{key:"bind",value:function(t,e){e.bindPass(this._material.getPassParameters(),t)}}]),i}(u.Z),C=(0,r.Z)({color:[1,1,1,1],transparent:!1,writeDepth:!0,writeLinearDepth:!1,vertexColors:!1,polygonOffset:!1,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1},c.z)},64226:function(t,e,i){i.d(e,{G_:function(){return c},IM:function(){return h},wp:function(){return s},W1:function(){return u}});var r=i(15671),n=i(43144),a=i(55158),o=i(33236),s=(0,a.U$)().vec3f("position"),u=(0,a.U$)().vec3f("position").vec2f("uv0"),h=(0,a.U$)().vec3f("position").vec4u8("color"),c=function(){function t(e){(0,r.Z)(this,t),this.vertexBufferLayout=e}return(0,n.Z)(t,[{key:"allocate",value:function(t){return this.vertexBufferLayout.createBuffer(t)}},{key:"elementCount",value:function(t){return t.indices.get("position").length}},{key:"write",value:function(t,e,i,r){(0,o.NK)(e,this.vertexBufferLayout,t.transformation,t.invTranspTransformation,i,r)}}]),t}()}}]);
//# sourceMappingURL=6366.a168fd5a.chunk.js.map