"use strict";(self.webpackChunketihadrailapp=self.webpackChunketihadrailapp||[]).push([[2113],{66038:function(e,t,n){n.d(t,{w:function(){return Z}});var i=n(15861),r=n(1413),a=n(15671),o=n(43144),s=n(60136),p=n(29388),c=n(87757),u=n(27366),l=n(91505),d=n(41691),h=n(84652),v=n(92026),f=n(66978),g=n(17842),m=n(49861),y=(n(25243),n(69912)),x=n(70178),_=function(){function e(t){var n=t.grabbableForEvent;(0,a.Z)(this,e),this.events=new l.Z,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=n}return(0,o.Z)(e,[{key:"intersectionDistance",value:function(e,t){return 0}},{key:"attach",value:function(){}},{key:"detach",value:function(){}}]),e}(),w=n(78005),T=n(14813),k=n(74229),S=n(84954),C=n(87268),V=n(34019),M=n(80151),b=n(99912),Z=function(e){(0,s.Z)(n,e);var t=(0,p.Z)(n);function n(e){var i;return(0,a.Z)(this,n),(i=t.call(this,e))._createOperationCompleted=!1,i._pointerDownStates=new Set,i._snappingPipeline=new M.n,i._snappingTask=null,i._stagedVertex=null,i.snapToSceneEnabled=null,(0,v.Wi)(e.elevationInfo)&&(i.elevationInfo={mode:e.hasZ?"absolute-height":"on-the-ground",offset:0}),i}return(0,o.Z)(n,[{key:"initialize",value:function(){var e,t,n=this;this.coordinateHelper=(0,T.Y6)(this.hasZ,this.hasM,this.view.spatialReference);var i="3d"===this.view.type?null==(e=this.view)||null==(t=e.resourceController)?void 0:t.scheduler:null;this._frameTask=i?i.registerTask(b.T8.SNAPPING):b.sq;var a="viewingMode"in this.view.state?this.view.state.viewingMode:2,o="segment"===this.geometryType||"multipoint"===this.geometryType?"polyline":this.geometryType;this._editGeometryOperations=new C.c(new S.XE(o,this.coordinateHelper,a)),this._activeComponent=new S.wA(this.spatialReference,a),this._editGeometryOperations.data.components.push(this._activeComponent),this.handles.add(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(function(e){var t=e.vertices.map((function(e){return{componentIndex:0,vertexIndex:e.index,coordinates:n.coordinateHelper.vectorToArray(e.pos)}})),i=t.map((function(e){return e.coordinates}));switch(e.type){case"vertex-add":n.emit(e.type,(0,r.Z)((0,r.Z)({},e),{},{added:i,vertices:t}));break;case"vertex-update":n.emit(e.type,(0,r.Z)((0,r.Z)({},e),{},{updated:i,vertices:t}));break;case"vertex-remove":n.emit(e.type,(0,r.Z)((0,r.Z)({},e),{},{removed:i,vertices:t}))}}))),this._manipulator=new _({grabbableForEvent:function(e){return"click"!==n.drawingMode||"touch"===e.pointerType&&n._snappingEnabled&&1===n._pointerDownStates.size}}),this.manipulators.add(this._manipulator),this._manipulator.grabbable="point"!==this.geometryType,this.handles.add([this._createManipulatorDragPipeline(this._manipulator),this._manipulator.events.on("immediate-click",(function(e){return n._onImmediateClick(e)})),this._manipulator.events.on("immediate-double-click",(function(e){return n._onImmediateDoubleClick(e)}))])}},{key:"destroy",value:function(){this._editGeometryOperations=(0,v.SC)(this._editGeometryOperations),this._frameTask=(0,v.hw)(this._frameTask)}},{key:"_snappingEnabled",get:function(){return(0,v.pC)(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}},{key:"canRedo",get:function(){return this._editGeometryOperations.canRedo}},{key:"canUndo",get:function(){return this._editGeometryOperations.canUndo}},{key:"committedVertices",get:function(){var e=this;return this._activeComponent.vertices.map((function(t){return e.coordinateHelper.vectorToArray(t.pos)}))}},{key:"drawingMode",set:function(e){this._set("drawingMode",null!=e?e:w.n)}},{key:"hasStagedVertex",get:function(){return(0,v.pC)(this._stagedVertex)}},{key:"interactive",get:function(){return this._manipulator.interactive},set:function(e){this._manipulator.interactive=e}},{key:"isCompleted",get:function(){return this._createOperationCompleted}},{key:"numCommittedVertices",get:function(){return this._activeComponent.vertices.length}},{key:"numVertices",get:function(){return(0,v.pC)(this._stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}},{key:"spatialReference",get:function(){return this.view.spatialReference}},{key:"stagedVertex",get:function(){return this._stagedVertex},set:function(e){if((0,v.Wi)(e))this.discardStagedVertex();else if(!(0,v.pC)(this._stagedVertex)||!(0,x.k)(this._stagedVertex,e)){if((0,v.Wi)(this._stagedVertex))this._stagedVertex=(0,h.d9)(e);else{if((0,x.k)(this._stagedVertex,e))return;this._stagedVertex.x=e.x,this._stagedVertex.y=e.y,this._stagedVertex.z=e.z,this._stagedVertex.m=e.m,this._stagedVertex.hasZ=e.hasZ,this._stagedVertex.hasM=e.hasM,this._stagedVertex.spatialReference=e.spatialReference}this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(e)}],operation:"apply",type:"vertex-update"})}}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"vertices",get:function(){var e=this.committedVertices;return(0,v.pC)(this._stagedVertex)&&e.push(this.coordinateHelper.pointToArray(this._stagedVertex)),e}},{key:"cancel",value:function(){this.complete({aborted:!0})}},{key:"commitStagedVertex",value:function(){if(this._snappingTask=(0,v.IM)(this._snappingTask),(0,v.pC)(this._stagedVertex)){var e=this._stagedVertex;this._stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(e))}}},{key:"complete",value:function(e){var t=e&&e.aborted||!1;(0,v.IM)(this._snappingTask),(0,v.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),"segment"===this.geometryType||"point"===this.geometryType?this.commitStagedVertex():this.discardStagedVertex();var n="multipoint"===this.geometryType&&0===this.numVertices||"polyline"===this.geometryType&&this.numVertices<2||"polygon"===this.geometryType&&this.numVertices<3;this._createOperationCompleted=!n,(this.isCompleted||t)&&this.emit("complete",{vertices:this.vertices.map((function(e,t){return{componentIndex:0,vertexIndex:t,coordinates:e}})),aborted:t,type:"complete"})}},{key:"discardStagedVertex",value:function(){this._stagedVertex=null}},{key:"onInputEvent",value:function(e){switch(e.type){case"pointer-down":this._pointerDownStates.add(e.pointerId);break;case"pointer-up":this._pointerDownStates.delete(e.pointerId)}switch(e.type){case"pointer-move":return this._onPointerMove(e);case"hold":return this._onHold(e)}}},{key:"redo",value:function(){this._editGeometryOperations.redo()}},{key:"undo",value:function(){(0,v.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}},{key:"_closeOnClickVertexIndex",value:function(e){var t=this._activeComponent;if("polygon"===this.geometryType&&t.vertices.length>2){if(this._vertexWithinPointerDistance(t.vertices[0].pos,e))return 0;if(this._vertexWithinPointerDistance(t.vertices[t.vertices.length-1].pos,e))return t.vertices.length-1}return null}},{key:"_createManipulatorDragPipeline",value:function(e){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(e);case"freehand":return this._createManipulatorDragPipelineFreehand(e);case"hybrid":return this._createManipulatorDragPipelineHybrid(e)}}},{key:"_createManipulatorDragPipelineClick",value:function(e){var t=this;return(0,k.Xd)(e,(function(e,n,i,r){var a="touch"===r&&t._snappingEnabled;!t.isCompleted&&a&&(n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&(t.stagedVertex=e.mapStart,("segment"===t.geometryType||a&&0===t.numVertices)&&t.commitStagedVertex()),e})).next(t._snappingPipeline.createSnapDragEventPipelineStep({predicate:function(){return a},cancel:i,snappingManager:t.snappingManager,snappingContext:new V.N({editGeometryOperations:t._editGeometryOperations,elevationInfo:t.elevationInfo,pointer:r,visualizer:t.snappingVisualizer}),updatingHandles:t.updatingHandles}),t._snappingPipeline.next).next((function(e){return a&&(t.stagedVertex=e.mapEnd,"end"===e.action&&t.commitStagedVertex()),e})).next((function(e){return"end"===e.action&&("segment"!==t.geometryType&&"point"!==t.geometryType||t.complete()),e})),i.next((function(){a&&(0,v.pC)(t.snappingManager)&&t.snappingManager.doneSnapping()})))}))}},{key:"_createManipulatorDragPipelineFreehand",value:function(e){var t=this;return(0,k.Xd)(e,(function(e,n){t.isCompleted||n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&((0,v.Wi)(t.stagedVertex)&&(t.stagedVertex=e.mapStart),"segment"===t.geometryType&&t.commitStagedVertex()),e})).next((function(e){switch(e.action){case"start":case"update":t.stagedVertex=e.mapEnd,"polygon"!==t.geometryType&&"polyline"!==t.geometryType||t.commitStagedVertex();break;case"end":t.complete()}return e}))}))}},{key:"_createManipulatorDragPipelineHybrid",value:function(e){var t=this;return(0,k.Xd)(e,(function(e,n){t.isCompleted||n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&((0,v.Wi)(t.stagedVertex)&&(t.stagedVertex=e.mapStart),t.commitStagedVertex()),e})).next((function(e){switch(e.action){case"start":case"update":t.stagedVertex=e.mapEnd,"polygon"!==t.geometryType&&"polyline"!==t.geometryType||t.commitStagedVertex();break;case"end":"segment"!==t.geometryType&&"point"!==t.geometryType||t.complete()}return e}))}))}},{key:"_getDrawSurface",value:function(){if((0,v.Wi)(this.elevationDrawSurface))return this.drawSurface;if(!this.coordinateHelper.hasZ)return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;var e=this.defaultZ,t=!1;(0,v.pC)(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(t=!0),(0,v.pC)(this.snapToSceneEnabled)&&(t=this.snapToSceneEnabled),(0,v.pC)(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(t=!1);var n=this._activeComponent.vertices.length;return("segment"===this.geometryType||"polygon"===this.geometryType)&&n>0&&(e=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),t=!1),t?this.drawSurface:(this.elevationDrawSurface.defaultZ=e,this.elevationDrawSurface)}},{key:"_mapToScreen",value:function(e){return this._getDrawSurface().mapToScreen(e)}},{key:"_onHold",value:function(e){(0,v.IM)(this._snappingTask),"click"===this.drawingMode&&"touch"===e.pointerType&&this._snappingEnabled&&(this.stagedVertex=e.mapPoint),e.stopPropagation()}},{key:"_onImmediateClick",value:function(e){if(!("mouse"===e.pointerType&&2===e.button||this._manipulator.dragging)){var t=this._activeComponent,n=this._closeOnClickVertexIndex(e.screenPoint);if((0,v.pC)(n))return e.stopPropagation(),this.discardStagedVertex(),void this.complete();var i=this._screenToMap(e.screenPoint);if((0,v.pC)(i))switch(this.drawingMode){case"freehand":"point"===this.geometryType&&(this.hasStagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(i)),this.complete());break;case"click":case"hybrid":this._snappingTask=(0,v.IM)(this._snappingTask),this.hasStagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(i)),("point"===this.geometryType||"segment"===this.geometryType&&2===t.vertices.length||"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===t.vertices.length)&&this.complete()}e.stopPropagation()}}},{key:"_onImmediateDoubleClick",value:function(e){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),e.stopPropagation())}},{key:"_onPointerMove",value:function(e){var t=this;if((0,v.IM)(this._snappingTask),!(this._manipulator.dragging||this._pointerDownStates.has(e.pointerId)||this._manipulator.grabbing)&&this._manipulator.interactive){var n=(0,g.vW)(e.x,e.y),r=this._closeOnClickVertexIndex(n);if((0,v.pC)(r)){this.discardStagedVertex();var a={componentIndex:0,vertexIndex:r,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[r].pos)};this.emit("cursor-update",{updated:null,vertices:[a],operation:"apply",type:"vertex-update"})}else{var o=this._screenToMap(n);if(this._manipulator.cursor=(0,v.pC)(o)?"crosshair":null,(0,v.pC)(o))if((0,v.pC)(this.snappingManager)){var s=this.snappingManager,p=new V.N({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:e.pointerType,visualizer:this.snappingVisualizer});this.stagedVertex=s.update(o,p),this._snappingTask=(0,f.vr)(function(){var e=(0,i.Z)(c.mark((function e(n){var i;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._frameTask.schedule((function(){return s.snap(o,p,n)}),n);case 2:if(i=e.sent,e.t0=i.valid,!e.t0){e.next=7;break}return e.next=7,t._frameTask.schedule((function(){t.stagedVertex=i.apply()}),n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.updatingHandles.addPromise(this._snappingTask.promise)}else this.stagedVertex=o}e.stopPropagation()}}},{key:"_screenToMap",value:function(e){return this._getDrawSurface().screenToMap(e)}},{key:"_screenToMapDragEventStep",value:function(){var e=this,t=null;return function(n){if("start"===n.action&&(t=e._screenToMap(n.screenStart)),(0,v.Wi)(t))return null;var i=e._screenToMap(n.screenEnd);return(0,v.pC)(i)?(0,r.Z)((0,r.Z)({},n),{},{mapStart:t,mapEnd:i}):null}}},{key:"_vertexWithinPointerDistance",value:function(e,t){var n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(e));return!!(0,v.pC)(n)&&function(e,t,n){var i=e.x-t.x,r=e.y-t.y;return i*i+r*r<=n}(n,t,25)}}]),n}(l.Z.EventedMixin(d.r));(0,u._)([(0,m.Cb)()],Z.prototype,"defaultZ",void 0),(0,u._)([(0,m.Cb)({value:w.n})],Z.prototype,"drawingMode",null),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"elevationDrawSurface",void 0),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"elevationInfo",void 0),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"geometryType",void 0),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"hasM",void 0),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"hasZ",void 0),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"manipulators",void 0),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"drawSurface",void 0),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"snappingManager",void 0),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"snappingVisualizer",void 0),(0,u._)([(0,m.Cb)()],Z.prototype,"snapToSceneEnabled",void 0),(0,u._)([(0,m.Cb)({readOnly:!0})],Z.prototype,"updating",null),(0,u._)([(0,m.Cb)({constructOnly:!0})],Z.prototype,"view",void 0),Z=(0,u._)([(0,y.j)("esri.views.draw.DrawOperation")],Z)},78005:function(e,t,n){n.d(t,{n:function(){return r},A:function(){return i}});var i=["freehand","hybrid","click"],r="click"},54016:function(e,t,n){n.d(t,{aL:function(){return c},hP:function(){return l},iW:function(){return u}});var i=n(15671),r=n(43144),a=n(92026),o=n(17842),s=n(65618),p=n(74509),c=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,i.Z)(this,e),this.elevationInfo=t,this.defaultZ=n,this.view=r,this.excludeGraphics=a}return(0,r.Z)(e,[{key:"screenToMap",value:function(e){if((0,a.pC)(this.defaultZ))return this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,o.s1)(e.x,e.y),this.elevationInfo,this.defaultZ,this.excludeGraphics);var t=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,o.s1)(e.x,e.y),this.elevationInfo,0,this.excludeGraphics);return(0,a.pC)(t)&&(t.z=void 0),t}},{key:"mapToScreen",value:function(e){var t=(0,s.Tx)(e.x,e.y,(0,p.vQ)(this.view,e,this.elevationInfo),e.spatialReference);return this.view.toScreen(t)}}]),e}(),u=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];(0,i.Z)(this,e),this.view=t,this.elevationInfo=n,this.exclude=r}return(0,r.Z)(e,[{key:"screenToMap",value:function(e){var t=this.view.toMap(e,{exclude:this.exclude});return(0,a.pC)(t)&&(t.z=(0,p.Ou)(t,this.view,this.elevationInfo)),t}},{key:"mapToScreen",value:function(e){var t=e;return(0,a.pC)(this.elevationInfo)&&(t=(0,s.Tx)(e.x,e.y,(0,p.vQ)(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(t)}}]),e}(),l=(0,r.Z)((function e(t){(0,i.Z)(this,e),this.view=t,this.screenToMap=function(e){return t.toMap(e)},this.mapToScreen=function(e){return t.toScreen(e)}}))},3826:function(e,t,n){n.d(t,{Gn:function(){return _},Q8:function(){return g}});var i=n(60136),r=n(29388),a=n(15671),o=n(43144),s=(n(59486),n(92026)),p=n(22018),c=n(89494),u=n(48976),l=n(98131),d=n(11186),h=n(71353),v=n(7882);function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,s.pC)(n)?[e,t,n]:[e,t]}function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,s.pC)(n)?{x:e,y:t,z:n}:{x:e,y:t}}var m=function(){function e(t){(0,a.Z)(this,e),this.spatialReference=t}return(0,o.Z)(e,[{key:"mapToLocalMultiple",value:function(e){var t=this;return(0,s.lV)(e.map((function(e){return t.mapToLocal(e)})))}},{key:"doUnnormalization",get:function(){return!1}}]),e}(),y=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(e,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,a.Z)(this,n),(r=t.call(this,i)).defaultZ=o,r.transform=(0,c.c)(),r.transformInv=(0,c.c)(),r.transform=(0,c.a)(e),(0,p.a)(r.transformInv,r.transform),r}return(0,o.Z)(n,[{key:"makeMapPoint",value:function(e,t){return f(e,t,this.defaultZ)}},{key:"mapToLocal",value:function(e){return g(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}},{key:"localToMap",value:function(e){return f(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this.defaultZ)}}]),n}(m),x=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(e,i){var r;(0,a.Z)(this,n),(r=t.call(this,e.spatialReference)).view=e,r.defaultZ=null,r.pWS=(0,h.c)(),r.tangentFrameUpWS=(0,h.c)(),r.tangentFrameRightWS=(0,h.c)(),r.tangentFrameForwardWS=(0,h.c)(),r.localFrameRightWS=(0,h.c)(),r.localFrameUpWS=(0,h.c)(),r.worldToLocalTransform=(0,l.a)(),r.localToWorldTransform=(0,l.a)(),r.scale=1,r.scale=e.resolution,r.referenceMapPoint=i,r.defaultZ=i.hasZ?i.z:null;var o=e.state.camera.viewRight;r.view.renderCoordsHelper.toRenderCoords(r.referenceMapPoint,r.pWS),r.view.renderCoordsHelper.worldBasisAtPosition(r.pWS,0,r.tangentFrameRightWS),r.view.renderCoordsHelper.worldBasisAtPosition(r.pWS,1,r.tangentFrameUpWS),r.view.renderCoordsHelper.worldBasisAtPosition(r.pWS,2,r.tangentFrameForwardWS);var s=(0,h.c)();return(0,d.a)(s,r.tangentFrameForwardWS,(0,d.d)(o,r.tangentFrameForwardWS)),(0,d.f)(r.localFrameRightWS,o,s),(0,d.n)(r.localFrameRightWS,r.localFrameRightWS),(0,d.c)(r.localFrameUpWS,r.tangentFrameForwardWS,r.localFrameRightWS),(0,u.r)(r.worldToLocalTransform,r.localFrameRightWS,r.tangentFrameRightWS),(0,u.i)(r.localToWorldTransform,r.worldToLocalTransform),r}return(0,o.Z)(n,[{key:"doUnnormalization",get:function(){return"global"===this.view.viewingMode}},{key:"makeMapPoint",value:function(e,t){return f(e,t,this.defaultZ)}},{key:"mapToLocal",value:function(e){var t=(0,h.c)();this.view.renderCoordsHelper.toRenderCoords(new v.Z({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),(0,d.q)(t,t,this.worldToLocalTransform);var n=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return(0,s.pC)(n)?g(n.x/this.scale,n.y/this.scale):null}},{key:"localToMap",value:function(e){var t=(0,h.c)();this.view.renderCoordsHelper.toRenderCoords(new v.Z({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),(0,d.q)(t,t,this.localToWorldTransform);var n=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return(0,s.pC)(n)?f(n.x,n.y,this.defaultZ):null}}]),n}(m);function _(e,t){if("2d"===e.type)return new y(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if("3d"===e.type){var n=t.length>2?new v.Z({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new v.Z({x:t[0],y:t[1],spatialReference:e.spatialReference});return new x(e,n)}return null}},80151:function(e,t,n){n.d(t,{n:function(){return v}});var i=n(15861),r=n(1413),a=n(15671),o=n(43144),s=n(87757),p=n(92026),c=n(66978),u=n(70178),l=n(74229),d=n(34019),h=n(99912),v=function(){function e(){(0,a.Z)(this,e),this.next=new l.hM}return(0,o.Z)(e,[{key:"createSnapDragEventPipelineStep",value:function(e){var t=this,n=e.predicate,a=void 0===n?function(){return!0}:n,o=e.cancel,v=e.snappingManager,f=e.snappingContext,g=e.updatingHandles;if((0,p.Wi)(v))return function(e){return e};var m=null,y=null,x=function(){m=(0,p.IM)(m),v.doneSnapping(),(0,p.pC)(y)&&y.frameTask.remove(),y=null};return o.next((function(e){return x(),e})),this.next=new l.hM,function(e){if(!a(e))return e;if(m=(0,p.IM)(m),"start"===e.action){var n="3d"===v.view.type?v.view.resourceController.scheduler.registerTask(h.T8.SNAPPING):h.sq;y={context:new d.N({editGeometryOperations:f.editGeometryOperations,elevationInfo:f.elevationInfo,pointer:f.pointer,vertexHandle:(0,p.pC)(e.info)?e.info.handle:null,excludeFeature:f.excludeFeature,visualizer:f.visualizer}),originalPos:(0,p.pC)(e.snapOrigin)?f.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,frameTask:n}}if((0,p.pC)(y)){var o=y.context.coordinateHelper.vectorToDehydratedPoint(y.context.coordinateHelper.arrayToVector([y.originalPos.x,y.originalPos.y,y.originalPos.z]));o.x+=e.mapEnd.x-e.mapStart.x,o.y+=e.mapEnd.y-e.mapStart.y;var l=e.mapStart.x-y.originalPos.x,_=e.mapStart.y-y.originalPos.y,w=(0,r.Z)((0,r.Z)({},e),{},{action:"udpate"}),T=y.context,k=v.update(o,y.context);if(e.mapEnd.x=k.x+l,e.mapEnd.y=k.y+_,"end"!==e.action){var S=y.frameTask;m=(0,c.vr)(function(){var e=(0,i.Z)(s.mark((function e(n){var i,r;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.schedule((function(){return v.snap(o,T,n)}),n);case 2:if(!(i=e.sent).valid){e.next=8;break}return e.next=6,S.schedule((function(){return i.apply()}),n);case 6:r=e.sent,(0,u.k)(r,k)||(w.mapEnd.x=r.x+l,w.mapEnd.y=r.y+_,t.next.execute(w));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),g.addPromise(m.promise)}}return"end"===e.action&&x(),e}}}]),e}()}}]);
//# sourceMappingURL=2113.a7c96f7a.chunk.js.map